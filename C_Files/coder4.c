//Usage
// gcc coder4.c -lm
// ./a.out > out4.txt

#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <math.h>

#define in_rows 4                  //Input rows
#define in_cols 128                 //Input columns
#define w_cols 16                 //Weights columns

void matmul(int inp_rows, int inp_cols, int wgt_cols, double inp[inp_rows][inp_cols], double  wgt[inp_cols][wgt_cols], double outp[inp_rows][wgt_cols]){
   int i, j, x;
   for (i = 0; i < inp_rows; i++) {
        for (j = 0; j < wgt_cols; j++) {
            outp[i][j] = 0;
            for (x = 0; x < inp_cols; x++) {
                *(*(outp + i) + j) += *(*(inp + i) + x)
                                     * *(*(wgt + x) + j);
            }
        }
    }
};

void transpose(int inp_rows, int inp_cols, double inp[inp_rows][inp_cols], double outp[inp_cols][inp_rows]){
    for(int i = 0; i < inp_rows; i++){
        for(int j = 0; j < inp_cols; j++){
            outp[j][i] = inp[i][j];
        }
    }

};

void softmax(int inp_rows, int inp_cols, double inp[inp_rows][inp_cols], double outp[inp_rows][inp_cols]){

    double m, sum, offset;

    for(int j = 0; j < inp_rows; j++){    

        m = -INFINITY;
        for (int i = 0; i < inp_cols; i++) {
            if (inp[j][i] > m) {
            m = inp[j][i];
            }
        }

        sum = 0.0;
        for (int i = 0; i < inp_cols; i++) {
            sum += exp(inp[j][i] - m);
        }

        offset = m + log(sum);

        for (int i = 0; i < inp_cols; i++) {
            outp[j][i] = exp(inp[j][i] - offset);
        }
    }
};

void single_head(int inp_rows, int inp_cols, int wt_cols, double X[inp_rows][inp_cols], double WQ[inp_cols][wt_cols], double WK[inp_cols][wt_cols],  double WV[inp_cols][wt_cols], double Z[inp_rows][wt_cols]){
    double norm = sqrt(wt_cols);
    double Q[inp_rows][wt_cols], K[inp_rows][wt_cols], V[inp_rows][wt_cols];

    matmul(inp_rows, inp_cols, wt_cols, X, WQ, Q);
    matmul(inp_rows, inp_cols, wt_cols, X, WK, K);
    matmul(inp_rows, inp_cols, wt_cols, X, WV, V);

    double KT[wt_cols][inp_rows];
    transpose(inp_rows, wt_cols, K, KT);

    double QKT[inp_rows][inp_rows];
    matmul(inp_rows, wt_cols, inp_rows, Q, KT, QKT);
    
    for(int i = 0; i < inp_rows; i++){
        for(int j = 0; j < inp_rows; j++){
            QKT[i][j] = QKT[i][j]/norm;
        }
    }  

    double softop[inp_rows][inp_rows];

    softmax(inp_rows, inp_rows, QKT, softop);

    matmul(inp_rows, inp_rows, wt_cols, softop, V, Z);
};


int main() {

    volatile uint64_t *time = 0xBFF8;   //Change the address here
    volatile uint64_t start1 = *time;

    //Input
    double X[in_rows][in_cols] = {674, -347, 834, 633, -423, -275, 504, -431, -470, -708, 994, -720, -627, 572, -328, 89, 89, -264, -730, 713, 788, 898, 418, -251, -439, -14, 528, -138, 753, 940, 561, 377, -712, 165, -543, -210, -418, -146, -204, -368, -892, 65, 603, -41, -193, 977, -590, 19, -314, -911, -430, 913, -926, 630, -829, 443, -263, -491, 111, -915, -46, -965, -283, 890, -717, 447, 719, -799, 222, -191, 72, -329, -15, 287, 648, 93, 540, 110, -513, 1, -185, 351, -486, -985, 744, 350, -268, 89, -950, 951, 635, 517, -87, 352, -799, 250, -63, 451, 84, 389, 917, 600, -54, 59, 713, -897, 868, 694, -627, -404, -609, 908, 903, -585, 805, -848, -895, -373, -263, -848, -266, 372, 554, -291, 148, 194, 680, -554, 
    838, 980, 728, 1010, -873, 973, -6, -527, 157, -93, -933, 20, 385, -79, 691, -693, -805, -558, -945, 738, 278, -938, 423, -496, -653, 26, -213, 763, 523, -601, 315, -924, 872, -945, 348, 792, 446, -561, -763, 942, 483, -610, -42, 288, 251, 230, -440, 104, -973, -876, -517, -964, 40, -261, 750, 403, 91, 574, 99, 221, 139, -739, 351, 338, -412, 272, -5, 622, 386, 796, 641, 750, 686, 337, 343, 879, -734, -398, 750, 984, 674, -433, -171, -485, 25, -375, -349, 26, 524, 764, 893, 808, -408, -15, 635, -184, -982, -1000, -867, -704, -605, -628, -131, -851, 268, -897, 0, 18, 1014, 85, 868, -130, -559, 254, 351, -248, -249, -204, 974, 987, -432, 501, 444, -417, -202, -476, 392, 183, 
    93, 531, -752, -129, -961, -937, -638, 65, 365, 101, 368, 19, 233, -591, 509, 679, 761, -612, -744, -906, -457, 838, 162, -780, 342, -454, -72, 466, -645, 884, 604, -626, 319, 285, 929, 622, -859, -252, -487, 8, -913, 798, 1021, -832, 811, -796, 108, 293, -87, 822, 697, 847, -680, 257, 387, 826, 642, -1002, 73, 604, -751, -1018, -268, 886, -947, 658, -548, -282, 151, -680, 351, -607, -291, -456, -185, 1009, -845, -31, -545, 60, -534, 246, 532, -513, 16, -899, 241, 567, -311, -177, -143, -725, -244, 516, -696, -717, -337, 669, -643, -614, 973, -585, -147, 204, -443, 48, 419, -879, 855, 343, -582, -703, 612, 232, 541, -567, 219, 506, 475, -703, -245, -588, 746, -99, 882, 623, -679, 335, 
    274, -115, -683, -102, -776, 21, -336, -521, 972, 652, 403, -436, -67, -370, -309, 279, -543, 98, 655, 158, -193, 891, 512, -439, 283, 661, -845, -769, 88, 305, 554, 25, -133, 65, -375, -290, -623, 82, 912, -4, 155, -778, -921, 368, -528, 285, -565, 967, 312, -391, 799, -202, 173, 781, 330, 606, 916, 514, 939, -642, 837, -88, -820, 815, 880, -718, -1, 527, -511, 701, -111, -789, -959, 439, -879, 447, -256, 387, -997, -633, 419, 413, 641, -462, -570, -971, 978, 142, 367, 705, 7, -308, -79, 797, 895, -272, -798, -647, 401, 855, -427, 365, 199, -782, -80, -797, 557, 905, -98, -271, 786, 757, 969, -491, 387, -916, 406, 843, 453, 387, -387, -963, 80, -757, -55, 232, -890, 720};
    //Weight matrices for every head
    double WQ[in_cols][w_cols] = {-276, 643, -596, 199, 107, 877, -179, -419, 261, 866, 243, 949, 869, 232, -326, 985, -908, -783, 97, -729, 910, -660, 726, -896, -456, 412, -882, -479, 274, 962, 484, 924, 652, -8, -483, -109, 891, -228, -238, 92, -33, 1005, 775, 393, -85, 1020, 5, -269, -853, 523, -1017, 701, -971, 256, -193, 598, -943, 38, -596, -830, -972, -417, 585, 121, 18, -775, 51, -715, -912, 246, -938, -316, -282, 741, -500, 845, 83, -888, 433, -267, 465, -171, -163, 525, 973, 677, -46, -468, 32, 131, -805, 554, 612, 288, 931, 973, 510, -567, -790, -436, 937, 257, 969, 991, -679, 739, -427, -339, -196, -693, 899, -840, -638, -1004, 296, -152, -959, 31, -211, -261, 679, 875, 37, -432, 224, 899, -867, 470, 
    -964, 31, -485, -849, 217, 883, -174, -785, -964, 2, 458, -641, 720, -581, 199, 503, -262, -32, 516, 605, -380, -125, 177, 776, 396, 671, -207, 726, -155, -921, 255, 859, -89, 1013, -282, -220, 498, -679, -925, -482, -1010, 350, -192, -620, 547, -962, -157, 320, -230, -33, -67, -19, 988, 550, 298, -563, -182, -971, 446, 748, -504, 293, 341, -211, 129, 125, -14, -201, -77, 798, -675, 633, -127, -898, 10, -849, 801, 89, -766, -336, 530, 637, -805, 514, -98, -189, -755, 182, -897, 658, 864, -661, -1001, -542, -54, 53, -912, 637, -225, 10, 256, 914, -497, -939, -134, -270, 392, 596, 1016, 342, 687, 669, 1012, 677, -641, -64, -377, 423, -787, -447, -727, 285, 298, -542, 43, 1017, -446, -763, 
    880, -566, -414, -928, -137, -10, -745, -769, 331, 904, -992, -81, -213, 707, 769, -447, -19, -708, -716, -415, -36, 196, 226, 319, -135, 313, -490, -976, 690, 51, -733, -245, -904, 314, -925, 972, 1021, 764, -314, -26, 655, -77, -590, 782, 286, 376, -742, 802, -37, -20, 244, 836, 493, -654, -75, 129, -657, -1008, 303, -90, 806, 539, -447, -72, -624, 439, 868, 794, 887, 447, -533, -197, -867, 527, 793, 798, -341, -501, -807, -860, -5, -960, 854, -752, -222, -8, -899, -245, -460, 1017, -146, 472, -803, 351, 388, -276, -549, 892, -37, -624, -87, 69, -321, -663, 995, -640, -453, -564, -106, -314, 876, 369, -443, -458, 941, 890, 698, -348, 859, 993, 393, -253, 602, -410, -182, 2, 209, 333, 
    938, 458, -911, -432, 598, -993, -558, -387, -204, -468, 533, 110, -270, 130, -153, 340, -1006, 119, -885, 361, -294, 912, -270, 381, 718, 673, -971, -679, 613, -210, -430, 187, 667, -848, -466, 106, -540, 29, -249, -1003, 460, 970, 746, -411, -286, -750, -947, 589, 498, -784, 510, -342, 222, 942, -976, -50, 636, 165, -656, -551, 161, -105, -382, 272, -27, -375, -181, -873, -140, -96, -140, -753, 323, -114, 1009, -994, 640, 834, 246, 772, -304, 493, -412, 489, -419, 747, 879, 628, 379, 747, -637, 655, -605, 75, -601, 1021, 229, 700, -265, 335, -69, -300, -149, 701, 543, -526, 583, 640, 868, 512, 480, 946, 301, 382, -167, -352, 608, -412, -544, -528, 449, -500, 781, -413, -979, -522, -971, -619, 
    -1013, -232, 442, 359, 825, -287, 444, 172, 256, 632, -142, 1006, -730, -131, -40, 396, 837, 393, 56, 358, -43, -788, 1000, -703, 788, -285, 633, -523, -378, -524, 674, 944, -659, -422, -191, 324, 944, 276, 729, -114, 182, 413, -92, -578, -477, 285, 475, 843, 825, 210, 339, 249, -882, -368, 703, 599, -719, 756, 874, -224, -629, -497, -144, -974, -726, -488, -836, 352, 475, -85, 58, -904, 518, 769, 813, -987, 284, -420, -522, -668, 13, -1016, 793, 582, 1003, 60, -1020, -691, -195, -86, -749, -435, 610, 573, 498, -447, 375, 362, 663, -26, 898, -430, -297, 769, 656, -772, 693, -79, -193, -813, 549, 881, -326, 712, -602, 473, 584, 935, -225, 645, 30, 768, -900, -876, 948, -359, 578, -538, 
    -308, 483, -748, 262, -1022, 665, -673, -467, -9, 994, -193, -553, 736, -788, 426, -112, -580, 388, -119, 69, -330, -595, -871, -786, 787, 219, -799, -494, -1023, -376, -220, -419, 1004, 479, -482, -557, -864, 675, -458, -896, 677, -37, -841, 527, 378, 636, 901, -870, -118, 291, 901, -325, -569, -997, 991, 872, -81, 262, 625, 490, 376, 1010, 615, -304, 366, 666, -250, -296, -234, -291, 539, 143, -864, 774, 598, 651, -313, 184, 980, 318, 796, -731, 277, -293, -192, -1021, -238, 481, -437, -434, 816, -731, -827, 382, 248, 873, -186, -925, -13, -486, 586, -916, -389, 479, 623, -119, -147, 354, -869, -7, 931, 550, 875, 855, -1023, 521, -188, 988, 398, -908, 440, 418, -84, 673, -562, -732, 1002, 863, 
    721, -756, -374, 598, -563, -356, -652, 863, 858, 149, -778, 715, -919, -662, -55, 959, -482, -784, 831, -66, -775, 18, 241, 400, -799, -690, -733, -608, 72, 636, 97, 703, 809, 52, -756, 120, 74, 585, -736, -380, -960, -791, -92, 668, -219, 333, -565, 120, 428, -478, 243, 538, -300, 538, 158, -415, -262, -724, -970, -68, 942, -131, 428, 539, -383, 954, -647, -215, 125, 829, -370, 809, -764, 356, -396, 264, 21, -428, 959, -879, 874, 488, -815, -46, 71, -842, -461, -706, -154, 801, 844, 133, 607, 118, -180, -674, -243, 250, -623, -137, -967, -152, 910, -529, 399, 651, 845, -113, -159, 510, -891, 689, -762, 125, -427, 9, 972, -851, -87, 497, 733, 178, -616, 86, -425, 742, 132, -110, 
    538, 702, 557, -173, -910, -114, 569, -743, 283, -230, -358, -883, 56, 0, -371, 460, -521, 134, 362, -914, -71, -897, -861, -353, -984, 237, -638, -469, 0, -628, 139, -675, 351, -311, -563, 52, -361, 681, 518, -794, -352, 416, 932, 942, 966, 89, 56, 184, -280, -955, -268, 363, -575, -657, -940, 909, -93, -460, 775, -133, -977, -425, 90, -593, 344, -542, -668, -475, -680, 991, 382, -585, 177, 910, -933, 162, -963, -915, -902, -626, 498, 224, 194, 491, -551, -1013, 839, -605, 668, -406, -24, -196, 607, -404, -92, -393, 518, -784, -921, 211, -43, -176, -925, -444, -789, -1003, 491, -798, 388, -488, 92, 241, 895, 484, 569, -449, 647, 790, 501, -736, -588, -468, 146, -162, 463, 271, -193, -25, 
    -651, 581, 274, -68, 223, 568, 348, -823, 754, -349, -413, -136, 395, -542, -807, -892, 455, -742, -95, -77, -471, 70, 718, -485, -420, -998, -894, -34, 723, 726, 949, 227, -410, 662, 661, -893, 380, 635, 705, 575, 152, -393, 70, 150, -915, -625, -596, 187, 441, -249, 864, 911, 414, 1016, -787, -174, 433, 968, -983, -848, -54, -801, 492, 233, 128, 498, -609, 772, -902, -206, 336, 623, 254, 118, 297, -551, 245, 382, 308, 814, -442, 94, -549, -2, -741, -96, -965, 979, 85, 944, 391, -506, -446, -282, 6, 385, -795, 386, -988, -122, -547, 174, -280, -73, -78, -441, -513, -797, 347, -666, -460, -973, 605, 823, 913, -179, 8, -87, 404, 254, -616, -155, 215, -666, -561, 470, 741, -572, 
    759, -437, 79, 724, -154, -212, 701, 309, 862, 984, -20, -149, 296, 506, -390, -652, -106, -692, 31, 500, -430, 939, -782, 1, 268, 320, -273, -229, 38, -973, -949, -69, -46, 1022, -291, 553, -892, -137, -414, -844, -5, 228, -835, -761, -340, -976, -670, -720, -153, -163, -151, -836, -678, -578, -224, 471, 705, -827, 281, -851, -74, 38, -105, -752, -77, 402, 534, -693, 765, 328, 76, 411, -161, -576, -905, -258, -937, 999, -858, 27, -438, -190, -109, 858, -857, 918, -751, 257, 260, -90, -409, -298, 796, 564, -980, 615, -941, -100, 366, 949, 207, -110, 515, 293, -309, -450, -806, -337, 696, -902, 754, -22, -143, 113, -913, -336, -877, -626, -468, -348, 974, -11, 370, 660, -518, 602, 607, 990, 
    195, 450, 549, -854, 657, 979, 290, 937, -173, -579, -691, -506, 304, -616, 638, -626, 310, 569, 700, 538, 354, -741, 487, 390, -136, -249, -45, -1014, 832, -35, 146, -920, 18, -729, 525, 256, -683, -172, -509, -606, -857, -32, 186, -839, -187, 249, 430, 208, -94, 776, -932, -560, 113, 767, -531, -748, 42, 363, 502, -947, 20, -777, -102, -538, -359, 375, 164, -129, 561, -517, 733, 350, 637, 591, 84, -295, -109, 844, 321, -207, 114, 898, -700, 664, 468, 363, 527, -496, -404, -128, 643, -473, -120, -860, -5, -678, -906, -802, 51, 613, -622, 264, -857, -351, 218, 661, 266, 57, 200, 729, 162, 91, -507, 318, 127, -627, -901, 567, 293, -837, -941, -36, -557, -987, 783, 670, 305, 806, 
    -804, -468, -318, 386, 568, -503, -186, -716, 347, 492, -774, 279, -44, 659, -6, -361, 255, 86, -961, -94, -627, 24, 729, -160, -502, -675, -151, 337, 800, 267, -479, -37, -238, 663, -818, 347, -486, -622, 306, 776, -727, -229, 80, 825, -415, 438, -45, 581, 467, 303, -907, 110, -242, 716, 611, -682, 598, 766, 962, 374, -461, -851, -266, -230, -703, 148, -178, -797, -624, 862, 827, -698, -871, -358, 42, -218, 745, 137, -670, -722, 9, 60, 1013, -393, -661, -1013, 895, -500, 753, -84, -536, -557, 971, 68, -75, 968, 997, 214, 685, 166, 688, 915, -876, -844, -82, 636, 534, 59, -409, 944, -243, -42, 125, 87, -722, 786, -97, 200, 524, -121, 893, -87, 598, -537, 124, -416, -400, -518, 
    -960, 471, 388, 248, -168, -65, 652, 31, -791, -634, -954, -906, -612, -353, 430, -447, 492, -395, 937, 684, 1021, -229, 713, -380, -284, -154, 825, -299, 440, 989, -161, 171, -662, -805, 769, 628, 767, 817, 737, 364, 504, -802, 266, -485, -848, -914, 445, 997, -682, -363, 767, -369, -90, 691, 761, 734, 383, 103, -624, 832, 552, 672, -900, 420, -378, -503, -765, 945, -131, 607, 544, 108, -499, -443, -401, -651, -906, 507, 323, 159, 745, 446, -801, 206, -413, 349, -399, 803, -597, -874, 706, -542, 538, 260, 736, -376, 596, 728, 881, -699, -512, 214, 81, 654, 527, 575, -961, 1015, 371, -118, 434, 102, 875, -995, 519, 936, -612, -862, -203, -456, -963, -401, -909, -879, -644, 445, -939, -442, 
    172, 444, 229, 807, 867, -657, -141, -844, 452, 134, -792, -567, -1007, 389, -988, 543, 479, 301, 1008, 773, 94, -913, 707, -991, 513, -979, -688, -980, 663, -669, 879, 222, -396, 927, -177, -681, -231, -826, 918, 281, -42, 898, -972, 888, -705, 768, 569, 355, 106, -130, 342, -28, 108, -601, -443, 144, 595, -951, -672, 981, -164, -112, -975, -14, 630, 989, 661, -469, 562, 468, 157, 996, -498, 840, -614, -613, -68, 645, -195, -864, -734, -642, -694, -683, -30, 616, -219, -93, 500, -250, 447, 296, 502, -1017, -668, 284, -590, 297, -640, 459, -897, 253, -135, -558, -568, 619, -46, -536, -502, -926, 57, 374, -885, -1005, 113, 37, 239, 898, 545, 660, -248, 281, -630, 193, 474, 194, -298, 335, 
    696, -834, 772, 989, 933, -542, 171, 67, 161, 286, 783, 219, 327, 1001, -742, -719, 362, 117, 214, -990, -504, -144, -87, -387, -475, -992, -364, -854, -272, -34, 198, 333, 14, 846, 720, -172, 227, 12, 198, 403, 167, 252, -797, 733, -370, -958, 909, 525, -857, 815, 641, -633, -630, 357, -416, -464, -439, 142, -710, 937, 23, -301, -357, 353, -314, 599, 826, 556, 438, 666, 878, 821, -1000, 106, 468, -794, 921, 480, -745, 601, -293, 774, 187, -724, -22, 507, -460, 20, -45, -978, 702, -544, 238, -906, -212, -1008, -725, -624, -347, -126, -2, 692, -873, -755, 190, 513, -432, -534, -727, -74, 248, 73, -387, -479, -758, 79, -596, -756, 297, 410, 609, 708, -627, 707, -432, 886, -731, 835, 
    -333, -3, -635, 478, 907, 236, -884, -556, -612, 695, -871, 272, -273, 728, 396, 793, 765, -780, -726, -72, -889, 60, 616, 452, -246, 258, 1021, 581, -986, -438, 399, 908, -305, 127, 262, 217, -376, -494, 263, -261, -538, -602, -401, -755, -406, 216, 756, 35, 1014, 191, 331, -670, -938, 406, 462, 881, 609, 457, -202, -391, -852, 1011, 813, 999, 83, -283, 383, -46, -710, -797, -51, 294, 300, 83, 590, 1021, 413, 580, 859, -914, -27, -722, 201, 887, -482, 994, -340, -646, 722, -744, 677, 689, 936, -816, -192, 546, 475, 43, -679, -762, -970, 1024, 635, 954, -957, 350, 214, 21, -1018, -336, 931, -287, -1022, -651, -578, -653, -162, -467, 359, -412, 246, 666, -844, 915, -872, -908, -299, 946};
    double WK[in_cols][w_cols] = {539, 226, 508, 310, 77, 370, -709, 326, 297, 364, 558, 760, -942, 1006, -716, 828, -464, 1022, -242, -486, -250, -188, 0, -253, 830, 535, 689, -825, 992, 152, 632, 161, 412, -969, 607, -421, 713, 187, 170, -618, 359, 870, 28, 955, -459, -280, 496, 48, -661, -965, 937, 848, 598, 136, 62, -164, -139, -359, -472, 0, -788, 653, 161, 92, 103, -84, -823, -188, 661, 140, 499, -662, 345, 338, -831, 110, 561, 539, -142, 510, 568, -526, 855, -895, 750, -773, 127, 149, -564, 553, -433, 942, 967, -313, -548, -214, -751, -354, 827, -13, 394, -460, 550, 808, -508, 310, -89, 954, 909, -1017, 771, 203, 406, 457, -349, 783, -1, -929, -189, 928, 8, -30, -803, -324, 776, 333, -118, 155, 
    -272, -984, 1015, -293, -647, 797, 126, 112, -272, -88, 478, -810, -545, 52, 632, -864, -711, -989, 431, -492, 674, 604, -776, 997, -858, -119, 250, -484, -216, -779, -808, 553, 128, 631, 302, 710, 729, 257, -363, -758, -939, 427, 643, -230, 831, -384, -102, 149, -557, -731, -365, -548, -18, 950, -845, 451, -694, -3, -539, 86, 76, -63, -587, -982, -354, 341, -157, 1012, -576, -216, 904, 523, -334, -610, 324, 171, -950, 624, 964, 961, -623, -67, -804, -584, 47, -289, 901, 288, 585, 515, 759, -19, 330, 705, 396, -446, -469, 867, -967, 602, 608, 847, 460, -649, -355, -987, -798, -895, 530, -324, -308, -295, -192, 311, 428, -440, 715, -396, 959, -302, 820, -449, -936, 803, 957, 174, 25, 312, 
    14, 884, -400, -79, -835, 331, -723, -928, 274, -162, 800, 638, -35, 644, 43, 623, 143, -970, 110, -215, 469, -119, 878, 973, -115, 400, -49, 704, 880, 316, -733, -760, -794, 108, 11, -809, 65, -105, -929, 721, 605, 186, -544, -632, -528, 308, 445, -1011, 82, 616, -876, 884, -56, 709, -726, -449, -535, 443, -2, -853, 248, -195, -741, -748, -416, 48, -270, -652, 875, -799, -116, -661, -864, -89, 236, 481, -622, -703, -941, -318, 231, 354, 796, 389, 206, 336, -650, -35, -422, -385, -973, 318, -115, 254, 49, -855, 1023, 32, -978, 431, 263, -856, -673, -502, 135, -68, -634, 962, 290, 1024, 257, 707, 936, -18, -263, -22, 250, 720, 513, -346, -151, 972, 800, 231, 876, 177, 237, 598, 
    978, -441, -149, 69, 667, -9, -183, 874, -782, -43, 794, 625, -374, 53, -462, 951, 512, -383, -621, -921, -58, 405, -847, -772, 28, 55, -316, 226, -999, -130, -640, -515, 29, -7, 164, 131, 160, -4, 307, -498, 214, 52, -78, -848, -784, 256, 171, 131, -980, 551, 979, 68, -545, -70, 765, -376, -423, 194, 280, -400, 167, 244, -705, 44, -530, -50, 479, -991, -730, -54, -486, -746, 561, -942, -588, 660, 526, 655, 63, -400, 231, 699, 1000, 71, -107, 731, -56, -710, -406, -387, 73, 763, 829, 905, -300, -272, 669, 714, 50, 203, -508, 818, 714, -328, -850, 27, 665, 886, -374, 898, 392, -87, -670, 629, -912, 394, 883, -825, -651, 887, -647, -130, -272, -76, 334, -102, -467, -521, 
    822, 503, -749, 124, 480, 724, -619, 178, 622, 175, 427, -349, 636, -269, 968, -147, 73, -244, 607, 156, -930, -956, 194, -675, 906, 879, 91, 27, 92, -149, 1019, 578, -1019, 15, 570, -180, 208, -871, 43, -635, 192, 298, -90, 759, -95, -719, 134, -356, 416, 492, 199, 251, 759, -254, -742, 777, -752, 997, -813, -631, -148, -483, 72, -966, 184, 195, 53, -255, 166, 317, -897, -491, 401, -680, 682, -616, 216, 682, -59, -17, -391, -207, -245, 541, -704, -207, 275, -604, -986, 941, 677, -323, 179, 387, -421, 23, -1022, 623, 966, 834, 766, -895, -349, 531, -488, 829, -862, -315, -583, -925, -519, 120, 934, 245, -905, 245, -422, -406, -603, 820, -699, -177, 335, 1016, 192, -816, -929, -873, 
    839, 178, 482, 366, -5, -76, -925, 692, -726, -426, -565, -850, 741, -141, -177, -968, -343, -407, -263, -233, 1010, 843, 743, 752, -816, -798, 224, 1000, 665, -676, -672, 548, 661, -649, -594, -572, -218, 497, -596, 17, -744, 624, -670, -282, -130, 507, -427, -80, -136, -465, -139, 969, 392, 371, -860, -66, 7, -975, -901, -286, 944, 994, -73, -976, 151, -527, 260, 624, -987, 501, -747, 654, 520, 948, -677, -831, 733, -613, -205, -425, 589, -90, -976, 617, -567, -911, -376, 670, -395, -30, -243, -800, 586, 971, 584, -605, 722, 155, -70, -193, -1022, -957, -355, -1002, -846, -51, -913, 572, 268, 414, 323, -274, 312, -330, -442, -980, -701, 155, 494, -300, 716, -437, 703, -961, -721, -127, -571, -837, 
    -453, 867, -196, -842, 984, 359, 309, 748, -582, 507, -945, 1010, 31, 830, -26, -333, 472, 170, 38, -276, -641, 591, -979, -107, -1010, -953, -760, 386, 902, -77, 467, 364, -114, 417, 610, -517, 241, -141, 534, 773, 795, 187, -866, 990, -900, -452, 91, -269, -5, -145, 627, 324, -469, -830, 862, -551, 534, -525, -986, 712, -902, 698, 509, 331, -936, -838, -743, 706, 68, 862, -74, -300, 0, 602, 418, -680, 261, 555, -365, 912, 391, -635, -756, -1006, -250, -238, -111, -13, -151, -492, 974, -684, -860, 185, 66, -535, 399, -549, -848, 243, -25, -681, 872, 70, 98, -160, -222, 945, 283, -346, -854, 7, 527, -575, -136, 413, -11, 239, -941, 444, 901, 670, 957, -287, 100, 419, 39, -80, 
    510, 623, -354, 1018, -908, 175, 593, 695, 757, 266, 276, 874, -925, 321, 717, 1018, -692, 607, -579, 848, -1021, -450, 591, -436, 874, 622, -900, -960, 579, 623, 526, 154, -395, 246, -990, 77, -544, 524, 219, 268, -683, -189, 301, 95, -532, 437, 683, 803, 436, -796, -794, -848, -957, -229, 212, -716, -386, -324, -676, 874, 358, -543, 21, 1010, 284, 482, -33, 210, -306, -1008, -733, -492, 342, -553, -215, -366, -851, -983, -771, 604, 385, 583, 618, 978, -852, 472, -27, 362, 674, -160, -535, -530, 56, 177, 415, 890, -59, 488, -219, 513, -628, 753, -592, 30, 345, 310, -595, 301, 306, -461, -873, 219, 798, -701, 622, -398, 376, -568, 823, -9, 761, 251, 307, 487, -804, 944, 772, -836, 
    -654, -480, 531, 352, -232, 944, -800, 843, -885, -242, -890, 465, -811, -519, 1001, -27, -301, 487, 681, 749, 977, 358, -572, -362, 279, -540, 28, 899, -918, -849, 337, 979, -478, 53, 648, -88, -793, -126, -686, -46, 780, 308, -799, -483, 138, 103, -774, 187, -372, -38, -37, 63, 337, -676, -668, -324, -9, 337, 688, -403, 165, -49, -819, -270, 967, -375, 316, -613, 714, -233, -839, 196, 945, 762, -998, -144, -675, 367, -577, -464, -996, 105, -57, 412, -334, 415, 5, -981, 318, 836, -740, -776, -241, -836, -567, -446, -291, 260, -574, 482, 479, -839, 715, 702, 22, -829, 1009, -1010, 265, 590, -699, 683, -731, -226, 502, -792, 812, -354, 924, -115, 485, -228, -628, -569, 462, 466, 962, 875, 
    519, -714, 767, -696, -191, -524, 696, 852, -16, 966, 530, -44, -107, -725, 360, -1006, 382, -788, -95, -578, -381, -209, 304, 309, -939, -516, -618, -232, 22, -542, -575, -797, -930, -363, -831, -360, 996, -358, -907, -392, 511, 106, 587, 569, 89, 895, -752, 246, -298, 480, -337, 259, 956, -650, -935, -480, -907, 625, -632, 930, 598, 661, -333, 812, 985, 973, -119, 273, 595, 442, -313, -115, 350, 1018, 627, 73, -353, 114, -546, 724, -660, 258, 356, 353, -324, 136, -80, -452, 1006, -552, 621, 532, 530, -718, 493, 783, 298, 476, 812, 661, 33, 922, -56, 373, -423, 231, 503, 222, -204, 522, 378, -564, -11, 545, 488, 520, 36, -228, -496, -89, 50, 282, -612, -328, 853, 1016, 71, -406, 
    -15, -213, -657, 406, 696, 677, -378, 337, 617, -424, 349, 873, 725, 681, -599, -503, 296, -904, -490, 1006, 510, 584, 567, -813, -443, 73, 156, 753, 947, -44, -119, -477, -738, 267, 886, -132, -137, 258, 109, -544, 884, -742, 189, 429, 38, 566, -263, -888, 852, 278, 991, 842, 861, -457, 873, 751, 21, 646, 382, -283, 801, 680, -573, 867, -476, 464, 787, -335, 222, 201, -845, 985, 216, 176, 334, 546, 1020, 696, -84, -1002, 1008, 154, 404, -686, -805, 70, 745, -80, -53, 156, -927, -315, -87, -11, -587, 452, 169, -1, 94, -889, 681, 421, -228, 110, 96, -688, -492, -95, 999, 199, 164, -1008, -778, -546, -558, -34, 700, 625, 390, -595, -646, -800, 195, 664, 536, 372, 182, -175, 
    941, -101, -248, 580, -213, -672, 203, -257, 534, -495, -794, 527, -444, 597, -410, 869, 763, 389, 61, 665, -938, -573, -388, -877, -457, 47, 230, 850, -699, 447, -264, -613, 698, -26, -852, -193, -717, -515, -490, -159, -448, -79, 770, -724, 31, 717, -889, 101, 491, 507, 451, -613, 693, -178, 561, 472, 829, -85, 185, -300, -887, 385, -422, -92, -989, 919, 792, -13, -441, 350, -36, -262, 433, -141, -617, 5, 666, -849, -96, 614, 686, -892, 792, 543, 242, 794, -627, 356, -392, 922, -388, -839, 213, -835, -976, -818, -561, -472, -5, 363, 677, 607, 796, -981, -618, 264, 774, 552, -694, -336, -1017, 32, 151, -297, 13, 508, 720, -958, 349, 212, 900, 922, 102, -377, -424, -144, -366, -838, 
    71, -900, 957, 559, 936, -412, -199, 852, -211, 817, 384, 487, -998, 646, 63, -294, 111, -324, -554, 580, 0, 910, 819, -979, 539, 73, 16, -567, 880, -457, 643, -719, 282, -369, 208, -616, 532, -269, -752, 358, 416, 940, 358, -423, 304, 600, -1006, 502, 205, -957, -386, -650, 207, -5, 799, -608, 74, 437, -462, 738, -588, 962, -330, -618, -234, -958, -823, 615, 206, -659, -612, 86, -454, 611, 423, -803, 780, -4, -636, -284, -162, 737, -826, -728, -520, 76, 736, -393, 760, 749, 791, 498, 697, 28, 222, -473, 274, -407, -602, -497, -825, -54, 68, -261, 875, 947, -747, -37, 843, 195, 520, -190, -537, 30, 286, -530, 833, 560, 499, 76, -204, 676, 154, 872, 101, 925, -680, 594, 
    808, 202, -329, 822, 260, 738, -476, 931, -770, 10, 593, 114, -1011, 82, 323, -701, -732, 758, -304, 353, 929, 717, 725, 437, -755, 601, -888, 84, -526, 940, -395, -849, 338, -752, 922, 896, -623, -150, 243, -437, -705, -570, -105, -424, -350, 406, 979, 465, -771, -238, -412, -385, 817, -538, 737, -1021, -942, 387, 657, -779, -534, -755, 445, 567, -554, 852, 13, 760, 151, -872, -16, -855, 749, 177, 395, -487, -156, -626, -646, 673, 173, -624, -947, 820, -227, 330, -174, -759, 237, 815, 632, -126, -673, -867, -356, -271, -667, -894, -469, -783, 332, -217, 925, 78, 321, 753, -644, -1017, 851, 430, -230, 319, 635, -216, -347, 713, -598, -579, -956, 437, -917, -860, 866, -274, 912, -473, -46, -562, 
    507, -379, -400, -948, 761, 983, 736, 511, 711, -529, 780, 939, 983, -589, -518, 537, 14, -762, 451, 366, -687, -378, -141, 292, 599, 677, -616, -661, -808, -596, -934, -549, 1001, 118, 651, -629, 808, 384, 666, 596, -175, -543, -6, -482, 1023, -348, -652, -103, -173, 502, -256, -933, -34, 349, 174, 393, 404, 643, 145, 209, 361, 949, 500, -97, -32, -656, -905, 684, -775, -286, -909, -623, 896, -487, -195, -36, 678, -951, 901, 526, -187, 931, -873, -138, -873, 212, 751, 264, -864, -701, -797, 611, 800, -823, -487, -68, -149, -858, -88, 418, 606, 434, -431, -1015, -39, 40, -155, 620, -436, -957, 380, -969, 436, -979, -784, 559, -566, -55, -151, 568, -184, -333, -427, 856, -368, 542, -704, -402, 
    307, -977, 170, -20, -201, 534, 419, -504, 476, 194, 848, 777, 216, -113, 962, -544, -638, 884, -318, -97, -644, -192, 827, -383, 1, 1015, -1001, 625, 334, -760, -948, -21, -232, -306, 377, 864, 485, -776, -183, 378, -988, 905, 869, -601, 206, -520, -362, 156, -476, -140, -312, -94, -822, -595, -722, 219, -893, -48, -613, -733, 149, -470, 122, -282, 683, 971, 223, 893, 990, -114, -1013, -478, -300, -50, 121, 349, 29, 500, -680, -170, -479, -455, -949, -696, 208, 836, -573, 849, -287, -397, 22, 738, -14, 291, -383, -376, -791, 381, -193, -415, -312, -215, -261, -255, 548, 913, 49, 566, 185, -915, -914, -107, 785, 960, 309, -451, -954, 615, 886, 659, -71, 143, 756, -964, 80, 519, -366, -316};
    double WV[in_cols][w_cols] = {-846, -433, -941, 69, -920, -621, 346, -655, 867, 296, 980, 293, 542, 700, 721, 803, 852, -260, -485, -680, -837, 432, -710, -768, 486, 48, 854, 686, 153, 570, -698, -899, -838, 770, 570, -105, -302, 458, -241, 126, -981, 936, 326, -725, -44, 99, -275, 290, -155, 644, -677, -174, -234, 984, -689, -322, -768, 689, 328, -479, 140, 744, -985, -128, 613, -265, -721, -376, -964, -13, -822, 28, -521, 645, 118, 762, -340, 696, 727, -6, 159, -627, -513, 478, -398, 885, -969, -84, 321, 851, 730, -85, -675, -245, 158, 289, -352, -634, 371, 364, 677, 613, -312, -204, -55, -457, 311, -703, 752, 63, 9, 18, 316, -41, 576, 267, -920, -874, -297, 793, -178, -424, -310, 849, -328, -777, 1020, -718, 
    -607, 703, -253, 773, -572, 775, 912, -783, -184, -306, 163, 713, 381, 455, 512, -713, 502, 923, -312, 141, -732, 330, 532, -806, -30, 177, -169, -992, 868, -6, 833, -621, 815, -866, -136, -39, -574, -743, 259, 181, -263, -832, -811, -786, -655, -887, -625, 601, -1000, 154, 188, 147, 937, -295, -87, 675, 499, 847, -206, 430, 167, -965, 530, 1004, -745, 727, -331, 598, -105, 304, -459, -701, -610, 409, 524, -303, -387, -221, 389, 23, 781, 660, -496, 881, -747, 474, 848, 837, 705, -430, -369, 730, -407, 902, -766, -674, 796, 416, -145, 890, -353, 27, -711, 896, 959, -28, 8, 436, 804, 894, 493, -592, -12, 897, 431, -170, -983, -297, 519, 725, -588, 677, 661, -579, 436, -391, -900, -978, 
    -565, 657, 1018, -411, -15, -250, 877, 152, 645, 20, 646, 833, -953, 116, 943, 490, 758, -691, 115, 988, -709, 356, 657, 634, -157, -656, 52, -669, 315, -858, -275, -584, 325, 433, 172, -319, 299, -47, -271, 751, 917, -452, 883, 581, 371, 57, 878, 577, -409, 168, 731, -986, -141, 733, -235, -47, -402, -301, -533, 459, -65, 671, -489, -811, 567, -690, -730, -685, 609, -498, 286, 923, -630, 787, -894, -524, -284, -214, 405, 145, -582, -843, -345, -176, 730, 465, 558, 975, -619, 171, -717, -874, -533, 1023, 515, -418, -861, -182, -327, 416, -408, 230, 539, 819, 163, -284, 914, 896, 293, 651, 492, 385, 232, 22, 630, -395, 896, 989, -315, -623, 16, 547, 415, -533, 217, 938, -706, -580, 
    452, 447, -62, -214, -435, -103, 647, -944, -710, -802, -336, -1012, 443, 947, 474, 181, 469, 74, 603, 456, 796, -534, -256, -319, 866, 169, 382, 605, 673, -745, 995, -30, 386, 366, 109, 364, -126, -886, -1005, -622, 876, 95, -1004, 937, 567, 550, -465, 639, 798, 453, 319, -678, -1018, -941, 783, -596, -731, 979, 632, -46, 537, 446, -332, -54, 5, -45, -981, -856, 822, 36, 486, 851, -591, 97, 304, 101, 949, 99, -725, 755, -928, -203, 624, -30, 914, -255, -809, 517, -390, 855, -791, -491, 12, -537, 478, -389, 807, 668, 620, 200, 603, -879, 40, 666, -902, 374, 842, 90, -957, -186, -931, 421, -592, -327, 623, 611, -356, -396, 279, 368, -374, -169, 908, 915, 242, 407, 402, -111, 
    -805, 652, 122, 984, -119, 411, 369, -755, 290, -378, 380, -640, -846, 956, -155, -691, -344, -872, 494, -865, -252, -747, -462, -605, -825, 694, -488, -990, -563, 687, -316, 83, 398, 534, 955, 157, 603, -568, 517, -574, -271, 39, -11, 887, 932, 274, -206, -407, 775, 748, -388, 950, -394, 357, 986, 1000, -691, -817, 715, 484, 466, 314, 531, 416, -395, -218, 260, 1009, 545, -556, 612, -543, -109, 652, 1, -1013, -557, -18, 211, -762, -752, 475, 290, -540, -828, 712, 397, -539, 272, 730, -199, -300, -30, -957, 245, -14, -141, -725, 626, 73, 42, 774, 124, -37, 930, -351, -776, -368, 162, 220, -33, 530, -802, -889, 360, 244, 746, -613, 141, -986, -617, 745, 1008, -627, 635, 858, 571, -284, 
    -623, -817, -93, -1018, 124, 250, 250, -937, 910, -359, -429, -650, -386, 938, -353, -6, -1009, 338, 264, 310, -1013, -823, 418, -238, -784, -59, 736, 652, -985, -885, 82, 285, 812, 438, -261, -397, 193, -929, 532, 864, 662, -753, 401, -758, -799, 997, 554, -120, 683, -964, -651, 575, -350, -823, -11, 351, 182, 477, 607, -193, -727, 481, 504, -584, 260, -965, -50, 966, 95, 447, 952, 667, -648, 108, 58, 816, 858, -385, -557, 199, -964, -152, 368, 971, 377, 564, -108, 181, -700, -582, -103, -976, 571, -785, 203, -830, -131, -876, 3, -132, -292, 955, -639, -863, 168, 82, -682, -673, -15, -201, 297, -945, -697, -788, 256, -195, 978, -359, -236, -793, 219, -545, -694, -490, -153, 303, -257, -394, 
    -756, -944, 785, -276, 886, 99, -829, -276, -949, 214, 573, -30, 587, 993, 682, -538, 953, -684, 287, -383, -28, -64, -783, -291, -246, -111, -655, 535, 714, -235, -227, -309, -805, 437, 885, -212, -868, 995, 159, 871, 132, 979, -119, -697, 10, -999, 882, 901, -32, -121, 746, 462, -777, -724, -991, 130, -824, -721, -122, 296, -426, -291, -665, 553, 500, 718, 47, -10, -664, 888, -774, -673, 592, 381, -542, -358, -36, 520, 482, -684, 845, 767, -162, 1009, -654, -623, 334, -498, 913, -161, 142, 397, -419, -314, -736, -163, 568, 135, 368, 28, 673, 126, 92, -911, 874, 83, -255, -30, 716, 420, -809, -933, 396, 380, -574, 784, 755, 798, -533, -385, 1, 670, -974, -160, -353, 411, 79, 15, 
    598, 635, 338, -999, -253, -606, -847, -113, 94, -41, 915, -55, -132, 560, 704, -468, 991, -838, -903, 24, -860, 202, 351, 162, -616, -932, -248, 493, 408, 838, -437, 634, -21, 58, -266, 881, -800, 671, -515, 913, 411, -245, 606, 63, -777, 819, -498, -701, -710, -953, 661, -91, -319, -765, 91, 253, -538, 212, -252, 1010, 973, 678, 632, 406, -949, -874, -200, -129, 28, -858, 285, -445, 824, -702, -454, 509, -606, -345, -786, -115, 737, 705, -654, -385, 1006, 610, -544, 673, 502, 697, 958, 713, 715, -333, -316, 188, 666, 309, -978, 251, 955, 878, -263, -551, -888, 795, -138, -353, -545, -682, -218, -51, 101, 321, -203, -568, -928, 128, 391, -192, 210, 289, 551, -998, -325, -919, 677, -164, 
    19, -8, -187, -167, 334, -807, 151, -698, 1002, -483, 798, 922, 829, 1013, 312, -829, -413, 698, 317, -945, 870, 915, -942, -174, 335, -357, -176, 21, -138, -894, -232, -423, -604, -296, -574, 986, -854, -358, -542, 910, 617, 357, -47, 561, 170, -986, 277, -392, -476, 966, 345, -886, -1012, 383, -637, -737, 689, 826, 57, -890, 327, -745, 641, 634, -51, -417, 136, 590, -234, 902, -389, -693, 530, 334, 720, 166, 24, -659, -510, -992, 934, -444, -904, -11, 776, -343, -979, 835, -292, -607, 692, -864, -12, -937, -487, 1024, -182, -686, -445, 495, 1011, -569, -779, 802, 389, -11, -677, -681, -517, 366, 98, -171, 518, 650, 347, 815, -28, -641, 100, 883, 520, -874, 758, -935, -945, -315, 134, -176, 
    -300, -561, -93, 458, -679, 445, 1005, -920, -651, -562, -198, 822, -133, 838, 451, -616, 858, 505, -1018, -814, -398, -10, -178, -524, 368, -212, -257, 481, 70, 884, 85, -597, 709, 575, 972, -1020, 854, -975, 797, -493, -1000, -196, 656, -938, -45, -903, -734, 384, 850, 931, 420, -642, 579, -331, -888, -796, -189, 249, -107, -359, 82, -707, 607, 635, 92, -730, -320, 969, -364, -118, -595, 218, 104, 780, 557, 646, -506, 819, -191, -821, -756, 183, -824, -120, 453, -416, 307, -376, 788, 176, 889, 759, -777, -548, -374, -523, -603, 642, -653, -848, -688, -553, -512, 180, 346, -326, 72, -61, -294, 1003, 67, 981, 152, -571, 5, 18, 539, 359, -398, -621, -445, 381, 484, 861, 58, -999, -562, -745, 
    -208, -160, 339, 262, 485, 106, -457, -454, 284, -734, 974, -335, 117, -260, 450, 434, -334, 466, -895, 961, -140, 792, -884, 997, -233, -639, -100, -222, 572, -775, -982, -252, 630, 280, -367, -792, -272, -527, 184, -445, -537, -711, 253, 496, -104, -559, -430, -94, -645, -896, 442, 104, -674, -468, -244, -160, -153, -357, 599, -260, -463, -157, 26, -732, -394, -502, 139, -699, 549, 794, 469, -43, 104, 378, 874, 390, 192, -218, 36, -261, 168, -982, -889, -824, 564, 551, -239, -574, -39, 142, 977, 256, 211, -67, 529, -204, 872, -1014, 1023, 942, -627, 792, 218, -540, -704, -72, -102, 46, 52, 364, 400, 806, -918, 579, -249, 884, -537, -174, 727, 550, 444, 468, -695, 294, -402, 196, -945, -121, 
    288, -747, -30, 540, -615, 775, 286, 292, 614, 725, 587, -99, 308, -797, -372, -139, -437, -228, 395, 56, -1021, 3, -804, -881, 803, -437, -812, -670, 81, -790, -122, 29, 785, -76, 293, -306, 939, -365, 400, -44, 281, -431, -158, -622, -657, -724, 411, -920, -342, -573, 942, -803, 582, 357, 117, 456, 223, 733, 34, 948, -526, -742, -335, 866, -211, 997, 61, -951, -357, 256, 185, 164, -140, 502, -984, 482, -76, -722, -42, -379, -907, 16, 65, 793, 36, 350, 840, 683, -674, -340, 621, -406, -720, 448, -26, -189, -652, -687, -559, 417, 62, -165, 471, -558, 766, 409, -653, -219, 476, 268, 987, 515, -12, 265, -188, -188, 495, 602, -233, -241, -1007, -182, -58, 704, -716, -139, -228, -374, 
    713, 252, -436, 93, 694, -437, -991, 488, 411, -547, 398, -874, 351, 1004, 4, -287, 786, 705, -826, 568, -290, -341, -403, -885, 624, 201, -788, 213, 613, -361, -24, -921, -339, -1010, -935, 119, -714, -862, 291, -133, 976, 408, 474, 774, 902, 408, -52, 844, -842, 93, -800, 475, -675, 687, 339, -891, -640, 681, 443, -966, -910, 828, -130, -192, -306, 589, -678, 744, -532, -85, 473, -963, -431, -243, 480, 848, 753, 740, -578, 686, 429, 749, 209, 57, 490, -951, 52, -435, -547, 940, -813, -221, -1014, -831, 122, 695, 294, 174, 184, -342, -228, 71, 609, -438, 963, 668, 201, 862, -854, -481, 220, -428, -808, 430, 136, 983, -108, -516, -535, -296, -581, 302, -578, 924, 1003, 217, -663, 492, 
    477, -396, 231, 1004, 55, -122, -345, -325, -236, -617, 395, 887, 404, -596, 744, 898, 297, 778, -911, 215, -592, -513, -357, -16, 443, -291, -631, 404, 1024, -579, -269, -11, -567, 173, -381, -228, 103, -227, -207, -722, -793, 831, -514, 479, -699, -186, 697, 557, -268, 141, -24, 110, 766, -575, -956, -515, 280, 189, 514, -76, 527, 123, -991, -592, 126, 570, 263, 529, -497, 273, -567, 33, 159, 988, 113, -526, 935, 367, 1014, -631, 155, 193, -37, 735, 132, -469, -658, -884, -370, 309, -196, 15, -710, 408, 253, -103, -35, 115, -943, 28, -639, -833, 759, -928, -678, 167, -705, -607, 101, 590, 29, 320, 342, -155, -210, -57, 233, -935, 25, -913, -857, 873, 189, -500, -96, -825, -198, 437, 
    47, -575, -633, 470, 768, -250, 236, 427, 906, -266, 872, 433, 922, -337, -258, 441, -728, -952, 309, -6, -642, 161, 132, 578, 1018, 959, -57, -619, 25, 948, 877, 508, -528, 365, 489, 535, 100, 546, -857, 632, -530, -476, 677, 724, 151, 757, -884, -859, -974, -848, 873, 25, 499, 792, 287, -835, 671, 347, 444, 371, 352, 738, -254, 383, -514, -921, -755, 74, -166, -588, 630, 687, -733, -970, -737, 796, -897, -963, 793, -92, 816, -474, 929, -459, -924, 369, -59, -316, -186, -600, 144, -382, 524, 971, -885, -97, -221, -522, 81, 443, -398, 929, 741, -670, -148, -166, 3, -728, 732, -908, 625, 599, -329, -408, 165, -1014, -789, -733, -964, 1010, -372, -772, 136, 674, 899, 1010, -734, 636, 
    -467, 959, -217, -92, 942, -72, 440, 519, -614, 526, -650, -252, -383, -291, 582, -75, -749, 597, 80, -901, 946, 11, -688, -337, -336, -72, 604, -803, -463, 464, 703, -519, 155, -929, -626, -404, -503, 149, -563, 824, 533, -373, -370, -977, 746, 120, -287, 226, -945, 308, -567, -589, 391, 57, 980, -261, -102, 591, 779, -79, 472, 615, -579, 100, -592, -36, 1012, -323, 300, -936, 966, -737, -449, 988, -580, -250, 82, 132, 515, -651, 457, -663, 444, -414, -610, 47, -170, -387, -532, -885, 876, -691, -974, -946, -486, 702, -815, 442, -805, 16, -202, -85, -15, -399, -412, -956, -530, -467, -24, 348, -656, 19, 148, 747, 989, 626, -278, -818, 919, -813, 656, 208, 816, -708, -439, 72, 80, -1019};
    double Ztemp[in_rows][w_cols];  //single head output

    volatile uint64_t end1 = *time;
    printf("Init: %ld",(end1-start1));

    printf("Input: \n");
    for(int i = 0; i < in_rows; i++){
        for(int j = 0; j < in_cols; j++){
            printf("%lf, ",X[i][j]);
        }
        printf("\n");
    }
    printf("\n");

    volatile uint64_t start2 = *time;

    single_head(in_rows, in_cols, w_cols, X, WQ, WK, WV, Ztemp);    

    volatile uint64_t end2 = *time;
    printf("Comp: %ld",(end2-start2));

    printf("Output: \n");
    for(int i = 0; i < in_rows; i++){  
        for(int j = 0; j < w_cols; j++){
            printf("%lf, ",Ztemp[i][j]);
        }
        printf("\n");
    }
    printf("\n");

    return 0;                     

}        
    