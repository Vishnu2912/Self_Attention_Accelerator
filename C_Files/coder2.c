//Usage
// gcc coder2.c -lm
// ./a.out > out2.txt

#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <math.h>

#define in_rows 8                  //Input rows
#define in_cols 64                 //Input columns
#define w_cols 16                 //Weights columns

void matmul(int inp_rows, int inp_cols, int wgt_cols, double inp[inp_rows][inp_cols], double  wgt[inp_cols][wgt_cols], double outp[inp_rows][wgt_cols]){
   int i, j, x;
   for (i = 0; i < inp_rows; i++) {
        for (j = 0; j < wgt_cols; j++) {
            outp[i][j] = 0;
            for (x = 0; x < inp_cols; x++) {
                *(*(outp + i) + j) += *(*(inp + i) + x)
                                     * *(*(wgt + x) + j);
            }
        }
    }
};

void transpose(int inp_rows, int inp_cols, double inp[inp_rows][inp_cols], double outp[inp_cols][inp_rows]){
    for(int i = 0; i < inp_rows; i++){
        for(int j = 0; j < inp_cols; j++){
            outp[j][i] = inp[i][j];
        }
    }

};

void softmax(int inp_rows, int inp_cols, double inp[inp_rows][inp_cols], double outp[inp_rows][inp_cols]){

    double m, sum, offset;

    for(int j = 0; j < inp_rows; j++){    

        m = -INFINITY;
        for (int i = 0; i < inp_cols; i++) {
            if (inp[j][i] > m) {
            m = inp[j][i];
            }
        }

        sum = 0.0;
        for (int i = 0; i < inp_cols; i++) {
            sum += exp(inp[j][i] - m);
        }

        offset = m + log(sum);

        for (int i = 0; i < inp_cols; i++) {
            outp[j][i] = exp(inp[j][i] - offset);
        }
    }
};

void single_head(int inp_rows, int inp_cols, int wt_cols, double X[inp_rows][inp_cols], double WQ[inp_cols][wt_cols], double WK[inp_cols][wt_cols],  double WV[inp_cols][wt_cols], double Z[inp_rows][wt_cols]){
    double norm = sqrt(wt_cols);
    double Q[inp_rows][wt_cols], K[inp_rows][wt_cols], V[inp_rows][wt_cols];

    matmul(inp_rows, inp_cols, wt_cols, X, WQ, Q);
    matmul(inp_rows, inp_cols, wt_cols, X, WK, K);
    matmul(inp_rows, inp_cols, wt_cols, X, WV, V);

    double KT[wt_cols][inp_rows];
    transpose(inp_rows, wt_cols, K, KT);

    double QKT[inp_rows][inp_rows];
    matmul(inp_rows, wt_cols, inp_rows, Q, KT, QKT);
    
    for(int i = 0; i < inp_rows; i++){
        for(int j = 0; j < inp_rows; j++){
            QKT[i][j] = QKT[i][j]/norm;
        }
    }  

    double softop[inp_rows][inp_rows];

    softmax(inp_rows, inp_rows, QKT, softop);

    matmul(inp_rows, inp_rows, wt_cols, softop, V, Z);
};


int main() {

    volatile uint64_t *time = 0xBFF8;   //Change the address here
    volatile uint64_t start1 = *time;

    //Input
    double X[in_rows][in_cols] = {-237, -733, -192, 796, -395, 939, -612, -179, -212, 107, 239, 667, -77, -81, 354, 759, 813, -880, 261, 108, -645, -201, -36, 447, -576, 6, -922, -78, 154, 115, 478, -680, -77, -509, 234, 399, 543, 65, -16, -797, 719, -194, -733, -21, -980, 316, 77, 304, -373, 127, 449, 79, -130, 228, 996, 3, -720, -43, -620, 308, -1014, 195, -371, -156, 
    852, -957, 371, 349, -793, -25, -947, 692, 34, 210, 113, -499, 684, -784, 737, 435, 683, 721, -320, 972, -828, -759, -400, -130, -33, 431, 405, -36, 666, 354, -1005, 640, -392, -771, 1017, -697, 20, -226, 864, 943, 339, -375, -687, 600, -205, 175, 688, 703, 485, -477, -507, -236, 230, -423, -277, 435, -259, -635, 307, 25, 775, 775, 821, 426, 
    744, -799, -499, -596, 335, -938, -336, -132, -303, 502, 620, -535, 227, 101, -339, 769, -514, 98, -859, 185, -658, -623, -695, -540, -42, -32, 769, -737, 397, -241, -29, 248, 942, -20, -656, -554, -882, 372, -965, 920, -916, -490, -534, 300, 157, -647, 457, 879, -290, 51, -530, 478, -823, -388, -583, 132, 420, 1009, -719, -902, -91, -935, -490, 767, 
    281, -454, -277, -761, -64, 56, -314, 373, 508, 948, 603, -121, 777, -446, -646, 428, 372, -474, -52, 737, -203, -565, -640, 571, -807, -112, -332, 166, 885, 327, 761, -708, -192, 820, -816, -19, -555, -697, -596, -103, -442, -92, 708, -959, -338, 368, 694, -328, 153, -679, -178, 19, -104, -755, -78, 67, 371, -478, -502, 965, -125, -139, -424, -139, 
    -504, 857, 1014, -455, -122, 630, 5, 905, 427, -26, -104, 830, -957, -140, 18, -670, 684, -938, -581, -351, -638, -729, 808, -425, 562, -956, 982, -448, 798, -70, 282, -263, 956, -1019, 725, -73, 609, -122, 571, 885, -843, 643, -629, -44, -949, -813, -534, 532, -614, 733, 72, -691, -121, 647, -1011, 927, 494, -826, 454, 817, 236, -528, -977, -418, 
    -971, -512, 707, 461, -193, 913, -342, 79, -975, -746, -128, -357, -961, -776, 527, 939, 310, -859, -955, 447, -679, 726, -270, -511, -419, 862, -986, 689, 482, 856, -669, -680, 516, 915, -916, 256, -968, 952, 823, 950, -367, -975, 683, -775, 956, -602, -382, 738, 735, 991, -392, -784, -919, -510, 606, 23, -50, 93, 909, -1006, 665, -467, 828, 806, 
    441, 882, 101, 885, -76, 479, -503, -88, -917, -498, -983, -416, -900, -688, -342, -780, -468, -838, 744, -359, -142, -473, 746, -551, 659, 980, 835, 521, -725, -430, -1015, 959, 122, -663, -625, -836, 1008, 953, 805, -626, 872, -864, -894, -40, -924, 236, -376, 709, 676, 520, 915, -185, -357, -831, -606, -1002, 293, -982, -969, -982, 1004, 617, -144, -959, 
    394, 166, 734, 271, 65, -688, 163, 841, 174, -32, -971, 836, 389, 670, 525, -465, 401, 795, 329, -721, -451, -939, -14, -878, 696, 313, 758, -254, -991, -966, 403, 64, -607, 529, -381, 936, -770, 97, 294, 1, 589, -729, 776, -526, -820, -1011, -109, -439, -75, 272, 221, 386, -865, 105, 872, -826, -276, 843, -568, -857, 94, -666, 921, 930};
    //Weight matrices for every head
    double WQ[in_cols][w_cols] = {-463, -959, 628, 736, -503, 752, -314, -966, 442, 717, -231, 392, -681, 391, 823, 62, -400, -291, -37, 389, -466, 257, 752, -391, 297, -612, -691, -74, -823, 415, 45, -671, 430, -287, 391, -910, -688, -630, -170, -905, 858, -105, 869, -658, -170, 113, -338, 531, 488, -1002, 77, -167, -158, -150, -1004, 835, -11, 301, -613, 785, 335, -971, 407, -1019, 
    -327, 681, -718, 581, -406, 824, -123, -184, -975, 235, -762, 845, -455, 537, 877, 378, -961, 493, 558, -570, 75, 38, 874, -759, 704, 686, -279, -845, -452, 127, -247, 258, -488, -532, -511, -447, 378, 388, -994, 799, 643, 182, -130, -941, -290, 598, -993, -508, 546, 344, 739, 894, 388, 611, 178, 557, -482, -405, 895, -410, -77, -355, -26, -517, 
    -218, -313, -899, 355, 238, 63, -573, 296, 812, -81, 486, 575, -344, 605, -307, -91, 402, -1002, 505, 915, -1016, -662, -491, 579, -207, -198, -586, 963, 998, 90, -720, 103, 340, -914, -198, -870, 286, -526, 432, -386, 56, -128, 309, 404, 40, 344, 753, -899, 1010, 833, -696, 323, -410, 445, 883, 894, 598, 876, -142, 154, -162, -908, 29, 249, 
    905, -394, 911, -715, 601, 859, 935, -320, -931, -964, 957, 185, 667, -398, -469, -61, 135, -795, 307, -208, 166, 294, 496, -700, -923, 891, -776, -592, -802, 434, 117, 577, 822, -955, 37, 568, 949, 826, -261, -541, -902, -297, 441, -737, 412, -1001, 700, 572, -414, 665, -935, -567, 424, -795, -851, -742, 169, 302, -647, 811, 150, -422, 78, -667, 
    -496, 842, -429, -653, 375, 451, 465, -818, 41, -116, 358, -865, 613, -15, 325, 143, 863, -893, 817, 497, 101, 989, -899, -1002, -393, 376, -859, -398, -313, -660, 549, 472, 375, -81, 1010, -403, 314, 550, -642, 358, 173, -710, -483, 619, -206, 455, 102, -258, -298, 81, -1000, 217, -601, 221, 858, -798, -353, 682, 673, 796, -11, -558, 357, 436, 
    560, -668, 374, 334, 256, 829, 924, -977, 847, 377, -232, -792, 959, 894, 483, -429, 594, -109, -160, 428, 239, -476, -398, -656, 204, 317, -433, -289, 996, 890, -804, 670, -923, -565, -774, -758, -581, -928, 172, 344, 375, -497, -106, 814, 630, 781, 617, 794, -574, 142, -446, -395, 464, -354, -44, -348, 48, 233, 574, 643, 171, 245, 504, -967, 
    -429, -73, -373, -413, 452, 910, 651, 40, -468, -261, -602, -871, -984, 700, -250, 897, -203, 878, 106, 705, 586, 156, -463, 276, 1000, -801, 855, -481, 855, 20, -490, -882, 79, 524, -168, 252, 693, 275, 734, 656, 514, -839, 916, 627, 328, 554, -711, -974, -796, 480, 1019, 824, 838, -396, 73, -807, 577, -663, 976, 858, -290, 312, 672, -134, 
    -218, 409, 394, -291, -863, 377, -402, -695, 150, 598, -484, 188, -460, 982, 320, -686, -559, 18, 33, -464, -629, 421, -877, -863, 737, -572, 742, -908, -443, 270, -102, -767, -861, -344, 214, 703, -263, -1019, 281, 80, 28, -128, -391, -828, 269, 355, 403, 906, -994, 161, 461, -80, -277, 80, 110, -889, -857, -684, -306, -788, -549, 876, 167, 609, 
    -908, 579, 586, 314, 659, 414, 789, -623, -628, -127, 337, 512, 397, 291, -726, -942, 35, 437, 895, -1007, -693, -191, 1015, -1010, -143, -391, -1015, -97, -119, -574, 103, -243, 735, 170, -856, -97, 464, -47, -654, 410, -933, 878, -546, -926, -479, -410, -866, -622, 500, -789, -409, 274, -767, -802, -678, -275, 406, 221, -726, -466, 14, -3, 126, 129, 
    443, 800, 1002, -123, 805, -808, 269, 977, 649, -544, 987, -548, 191, -64, 852, -9, 321, -519, 547, 569, 940, -233, 425, -47, 499, 645, 646, 385, -786, -776, -149, 589, 352, -28, -506, -311, 523, -803, -966, 61, -444, -297, -877, 1022, 876, -901, -891, -828, 834, 140, -586, -211, 573, 84, 553, -243, -957, -948, -433, -970, 1020, -775, 694, -777, 
    -677, -454, 10, 108, 153, -687, -768, 894, -995, -662, -486, -202, 862, -857, 357, -135, -120, 460, -367, -508, -280, -322, -133, -244, -533, 564, -275, 959, 220, -758, 113, -253, 405, -719, -978, -904, 929, 666, 345, 719, 125, -470, 772, 774, 27, 849, 593, -510, 826, -214, 440, 224, 593, -946, 427, 863, -826, -594, -491, 748, 391, -342, -650, -869, 
    -867, 979, 699, -365, -622, -733, -264, -834, -582, 977, 474, 402, 423, -575, -894, -902, -149, 435, -58, 368, 347, -741, -252, -961, -485, 405, -980, -309, -731, -155, 886, -64, 526, 167, 766, 87, 398, 616, -267, -475, 254, 785, -64, -247, 420, 87, 395, 361, 1019, -809, -621, -569, -11, -145, 948, -907, -184, 741, 419, -220, 96, 1001, -407, 879, 
    -922, -754, -423, -698, 177, 612, 154, 553, -885, -769, -437, -755, -375, 171, -170, -953, 392, -704, -424, -160, -402, 756, -980, -843, -407, -739, 1010, 975, 368, 692, -543, -995, -482, -1019, -326, -435, 143, 441, 165, 110, -990, 496, -409, 242, -661, -1001, -405, 716, 656, 184, -947, -214, -574, -289, -1018, -308, 797, 397, 724, -175, -859, -381, -57, -376, 
    258, 16, 630, 633, 80, 935, -312, 823, 306, 292, -317, 854, -227, 535, 902, 50, 436, -955, 444, 695, 299, 383, -667, 583, -880, 536, -387, -475, -320, -741, -149, 185, 409, 218, -242, -249, -294, 981, 59, 460, -1016, -668, 618, -419, 743, -816, -821, -983, 9, -500, -891, 736, 388, 574, 524, 254, 186, -582, -492, -791, 716, 814, 148, -787, 
    -652, 215, -715, -416, -756, -561, 86, 389, 28, 36, -399, 518, -753, -189, 1013, -1014, -264, -771, 904, 229, -620, 227, -997, 542, 868, -517, 246, 71, -511, -487, 877, 797, 779, 93, -723, -649, 626, -181, -588, 798, -782, -993, 668, 59, -949, -991, 522, 333, -929, -304, 1018, -338, -94, -752, 1019, 892, 918, -548, 602, 803, 891, -1013, 335, -965, 
    664, 997, -162, 703, 548, 900, 809, -296, 416, -361, -950, -22, -799, -891, 1008, 181, 419, -4, -178, 716, 882, 963, 952, -756, 335, -431, -416, -681, -648, -737, 511, 764, -962, -425, 879, -935, -734, -421, 644, 291, 122, -274, 709, 341, 898, 687, -599, -708, 88, -904, -102, -794, -742, 530, 894, -87, 931, 130, 877, 822, 663, -222, 808, -173};
    double WK[in_cols][w_cols] = {517, -336, -280, 721, 881, -725, -518, -985, -13, 602, -262, -176, -511, -229, -783, 392, -257, 161, 308, -679, 316, 341, -863, -388, -542, 807, -209, -150, 676, -938, 526, 417, -920, -836, -730, 299, -991, -894, 751, -909, 440, -104, 2, -19, 363, 326, 447, -1012, 131, 618, 486, 842, 323, 361, 960, -844, -423, 768, 897, -869, 133, -764, 940, -439, 
    -418, 823, -877, 710, -96, -641, -264, -116, 652, -671, -984, 59, 493, -326, 381, -114, 923, -823, 707, -891, -480, -392, 491, 170, 254, -524, 547, -490, 282, -215, -1003, 640, 244, -494, 391, 279, -167, 51, -545, 785, -610, -104, -778, 463, 303, -882, -868, 987, -738, 706, 504, -119, 640, -67, 344, -879, -568, -882, -765, -713, 803, 836, -134, -779, 
    -627, 556, 416, 57, 843, -364, -779, -55, -494, 844, 839, -309, 702, 45, -810, -253, -285, -485, 55, 332, 1020, -237, -639, -979, -472, 764, 536, -383, 27, 139, 254, 196, -364, 668, 270, -685, 301, 259, 1016, -1014, 815, -1023, -689, -681, 752, 145, -284, -1018, 724, -102, 657, 1019, -362, 932, -640, -475, -76, -652, 1014, 891, -743, -303, -654, 84, 
    757, -470, 544, 394, 863, 482, 1, 499, 897, -711, -628, 737, -918, 190, 936, 831, -188, 768, 136, 173, 836, -663, -242, -739, -72, 520, 346, -576, 195, -950, -756, -201, 860, -414, 640, 323, 224, -579, 455, -850, -199, -816, -631, 669, -113, 441, 724, 869, -594, -511, 435, 746, 388, 222, 302, -131, -372, 491, -699, 910, -91, -104, -26, 716, 
    -974, -602, -628, 25, 46, 540, -547, -764, 805, -515, 652, -469, 410, -16, -403, 214, 736, -180, -92, 464, -233, -698, -729, -940, 193, -92, 913, 97, -924, 541, 595, 23, 376, 853, 756, -360, -183, -857, 1017, -234, 137, -364, -951, -26, -231, -248, 693, 117, 828, 89, -605, 397, -515, -795, 179, -955, 967, 440, 795, -949, 931, -860, -699, -9, 
    397, -428, -239, 811, 376, 936, 47, 744, -931, 674, -694, 325, 703, 790, 407, -331, 738, -365, -713, -561, -792, 394, 952, 719, -547, -529, -927, 1021, 431, 331, -402, -356, -392, 939, 590, 950, -584, -661, 125, -784, -524, 548, -937, 406, -328, -253, 414, -576, -727, -759, 666, 777, 209, -698, 390, 468, -842, 236, 831, -618, -260, -906, -201, -269, 
    -697, 981, -694, -435, 964, -427, -449, -699, 405, 951, -385, -807, 247, -636, -769, -114, -559, 436, -498, -50, 977, -479, -104, -433, 513, 754, 812, 818, 28, -617, -529, -275, -860, -392, 602, -839, -339, 785, -428, -913, -674, 239, 578, -543, -90, -765, 312, 292, -82, -253, 838, 977, 277, -336, 80, -149, 950, -289, -724, -449, 527, -214, -240, -788, 
    183, 254, 926, -112, -7, -417, 673, 377, -820, 534, 528, -518, -1004, -267, 253, 360, 712, -29, 156, 824, -436, -74, 268, 392, -929, 7, 126, -560, 192, 75, -237, 680, 71, -740, -614, 923, 555, -464, -585, -96, 595, 617, 171, 911, -386, 892, -919, 856, 637, 721, 937, 25, 76, 438, 441, -258, 547, -937, -550, 263, -937, 725, -942, 62, 
    -625, -308, 37, -616, -1011, -618, 501, 491, -27, 870, -58, -548, 876, -411, 510, 571, -507, -68, 450, 743, 189, -125, 279, 955, -999, -852, 85, 951, -844, -979, -675, 264, 864, -410, -194, 750, -694, -146, -681, 542, -334, 14, -621, 839, -363, 963, -518, -84, 151, 47, 182, -939, 181, -176, 83, -782, -640, 697, -265, 1013, -1007, -864, 271, -760, 
    -297, -218, 905, 19, 180, -742, 424, 728, 683, 808, 573, -425, 684, 782, 602, 391, -626, 470, 499, 268, -628, -426, 637, -473, 123, -49, -394, 618, 389, -625, 798, 890, 404, -770, -448, 168, -499, -1019, -482, 307, -140, 571, 84, 140, -260, -521, 634, -904, 199, 962, -453, 720, 114, -165, -888, 82, 443, 959, -512, -856, -589, 645, 956, 359, 
    332, 801, -616, -306, -210, -654, -266, -393, 705, 134, 666, 213, -700, -594, 158, -622, -536, -1007, 832, -865, 933, -674, -762, 521, -630, 256, 115, 929, 799, 233, -123, 922, -966, 201, 748, 234, 920, 795, 471, -105, 103, 491, 227, 214, -1000, 569, -469, -931, 858, -953, 895, 510, -764, 414, -51, 765, -790, -947, 627, -672, 109, -590, 387, -136, 
    -594, -498, -915, -265, 533, -393, 925, -712, 495, -513, -143, -49, -306, -726, 1016, -903, 305, 993, 33, 956, 796, -485, -10, -833, 556, 395, -898, -941, -633, 303, -591, 374, -839, 404, 839, -819, -469, 445, 766, -42, 685, -101, 933, 222, 992, 327, 831, -942, -940, 323, -208, -720, 613, -1002, -687, -826, -652, 759, -554, -841, -366, 792, 313, -338, 
    295, 845, 188, 521, -581, 167, -211, -352, 343, -770, -975, -285, 109, -633, 999, -706, 14, -394, 536, 342, 678, -963, 354, -274, -803, 322, -638, 641, 296, 743, 56, 110, 483, 538, 945, -977, -198, -851, -926, 394, 347, 54, -693, 244, -241, -720, 610, 22, -533, 337, -688, 42, 666, -890, -707, -46, 400, -679, -924, 120, -768, 643, 650, 1023, 
    -35, -510, -780, 552, -523, -743, 105, -124, 111, 141, 203, 371, -231, 203, 573, 367, -421, -617, 824, -499, -352, -111, -746, 78, 202, -715, -898, -902, 618, -661, 608, -908, 198, -719, -955, 209, -132, -300, -663, 170, 521, -678, 50, -597, 930, 476, 262, 317, 641, -420, -273, 794, 130, -926, 105, 917, -799, 290, -519, -412, 878, -497, 132, 564, 
    -440, -340, -582, 330, 519, 853, -842, -306, -51, 313, -715, 898, -429, -611, -1004, 993, -801, -760, -676, -729, -651, -696, -428, -206, -58, -337, -233, -717, 834, 485, 651, 325, -899, -199, 919, 285, 867, -48, 321, -373, 660, 622, 172, -709, -419, 740, 31, 463, -1017, 460, 1019, 791, 39, -647, -714, 103, 652, 844, 42, -610, -282, 408, 925, -313, 
    -683, 604, -397, 96, 251, -179, -455, -203, 211, 206, -878, -932, -701, -554, -17, 1, -80, -192, -546, 935, -247, -746, 120, -452, 675, 303, -798, -147, 509, -128, 398, 737, -367, -911, 641, 734, -125, 306, -1020, -970, -155, 97, -74, 441, -86, -914, -438, 707, -705, -908, -932, 976, -644, 156, -159, 318, -170, 454, -949, 902, -868, 619, -57, -491};
    double WV[in_cols][w_cols] = {962, -956, 135, 798, 911, 392, -430, 873, 964, 1000, 156, -494, 135, 926, 880, -251, 983, 636, -605, -228, -80, -551, 602, 710, -891, 560, -517, -6, -670, -1003, 41, 823, -932, -374, -870, 442, 55, -690, -507, -500, 482, 646, 68, 129, -249, -176, -318, -242, 600, 362, 194, -80, 167, 753, -750, 256, -504, -448, 939, -496, -91, 818, 385, -190, 
    47, -944, -707, 768, -781, -941, 562, 1016, -269, -718, 43, 751, 361, -123, 285, 304, 785, 747, -198, -455, -206, 890, 548, -672, -344, -45, -86, 78, -692, -543, -245, 199, -83, -498, 920, 331, 26, 448, 435, 763, 758, -447, 368, -269, -147, 635, -823, -718, 664, 337, -415, -530, -240, -629, -769, 3, 947, -497, 970, 805, 14, -165, -134, 899, 
    -120, 272, 591, 837, -189, -432, -757, -304, 272, -689, 976, -964, -337, 102, -150, -913, -901, 246, 638, -575, -41, 224, -983, -906, 26, -92, 651, -64, -532, -10, -726, -267, -482, -512, 772, -289, 319, -404, 375, 522, -986, 313, 80, 845, 144, -615, -158, 438, 649, -1024, 1011, -231, 777, -309, 166, 373, 281, 747, 851, -1001, 364, -515, -42, -256, 
    792, -186, -93, -194, 188, -948, 956, 355, -238, 422, -527, 398, -181, -95, -407, -482, -788, 286, -674, 249, 406, -443, -170, -187, 129, -31, 228, 459, -250, 54, 369, 65, 80, -9, 310, 680, -461, -844, 764, 193, 513, 438, -406, -549, -176, 654, 327, -558, -447, 409, -8, -830, -203, 530, -596, 334, 800, 274, -351, 885, 856, -260, -651, -533, 
    737, -739, 607, 940, 612, 753, -26, 161, 380, -954, 287, 876, 61, 987, 708, 198, 56, 226, 640, -427, 67, -606, -30, 442, -560, -107, -638, -286, 749, -352, 222, -843, -441, 222, -234, -361, -976, 244, 168, -993, 261, 231, -799, 560, -96, 81, 523, 245, -688, 58, 779, 321, -60, -692, -136, 894, 109, 246, -861, 370, 703, -703, 8, 727, 
    -921, 610, -111, 802, 19, 280, -1017, 320, 348, -639, 384, 695, 1012, 270, -658, -827, -651, 405, 858, -284, 676, 973, 49, 81, -522, -500, 350, 115, 868, -487, 912, 999, -567, 868, -121, 811, 103, -694, -658, 856, 788, 86, 506, -415, 965, -501, 27, -696, 562, 771, 269, 210, -990, -343, -700, 939, 747, 224, -979, 9, -415, -197, 329, -49, 
    -484, 257, 484, 532, 378, 322, 195, -287, -693, -130, -854, 977, 550, -797, 509, 551, 685, -449, -273, -613, -263, 156, -167, 258, 790, -821, -125, 962, 141, 879, 734, 685, 731, 676, 934, -502, -524, 254, 957, -128, -183, -114, 1009, 273, -170, 94, 500, -368, -917, 339, 464, 846, -849, -14, -13, -703, 896, -452, -954, -734, 266, -652, 797, 1011, 
    -243, -497, -707, 908, 813, 614, -663, 541, 993, 353, -568, -169, -964, 566, 876, 816, -821, -173, -744, 715, 203, -238, 282, 385, 840, 19, -280, -882, -568, -540, 301, 685, -19, 578, -87, 490, 838, -594, -1024, 499, -617, 587, 255, -331, 119, 462, -245, 244, 682, -891, -365, -462, -562, 762, -188, -614, -881, -635, -281, 418, -468, 704, 502, 761, 
    999, -825, 653, -977, -61, 455, 921, 762, -402, -255, 962, -971, 884, -773, 476, 521, -355, 758, 1012, -710, -529, 359, -399, 406, -586, -557, -1018, -570, 565, -228, -611, 890, 79, -625, 548, 581, -875, 369, 481, 88, 7, 1016, -338, 211, -921, -885, -1002, -175, 370, -891, -184, 790, 574, -491, 1006, 54, -55, -342, -8, 887, -424, 797, -849, 1, 
    392, -372, -987, 587, -131, 400, 432, -992, 258, 649, 144, -962, -871, 171, 993, -531, 130, -315, -733, -500, 380, -221, -448, 388, 437, 562, -57, -658, -28, 682, -783, -378, -743, 919, 223, -874, 8, -786, 719, -739, 111, -77, -100, 950, 913, 246, 114, 694, -3, 649, -116, 839, -196, 630, 689, 817, -920, 662, 155, 59, -335, -291, -496, -517, 
    -993, 841, 352, 521, 363, 986, -82, -118, 599, -471, 20, 186, 178, -681, 960, -2, -723, -516, -82, 705, -662, 494, -911, 189, 775, 200, -752, 495, 122, 981, 685, 837, -813, -953, -601, -285, 182, 186, 378, 76, -408, -95, 375, 252, 53, 163, -957, 221, 311, -274, 135, -859, 302, 487, 188, -241, -62, 896, 662, 908, -116, -73, 95, 68, 
    -592, 896, -763, -301, 416, -299, 703, 184, 776, 88, 240, -74, -85, -768, 381, -153, -760, 127, -425, 339, 81, 97, -59, 238, 74, 460, -121, 444, -993, -110, -448, 501, 909, 783, -789, 722, -517, -687, 569, -816, 466, -773, 91, 502, 394, -192, -363, 61, -745, 549, 700, -70, 33, -820, 508, 471, 816, 614, 663, -707, -597, -100, 854, 118, 
    325, -779, 932, -649, -558, 358, -617, -570, -972, -585, -962, -301, -175, -770, 1020, 8, 1011, -871, 562, 192, -23, 916, 41, -96, -997, -418, 803, -294, -129, 682, 426, 322, -308, -669, -472, -339, 73, -420, -882, -91, -406, 988, -977, 657, -34, -96, -1022, -1017, -853, -691, -658, -737, 850, 768, 18, 694, -329, 213, 662, -717, -164, 254, 878, 729, 
    156, -339, 530, 314, -102, 866, 983, -878, -917, 895, 170, 478, 337, -150, -742, -333, 355, -574, 203, -983, -823, 216, -212, -302, 105, -551, -432, -79, -324, 28, -754, -846, -604, 67, -967, -429, 686, 279, -404, 698, 319, -621, 130, 505, -154, -928, -520, -110, -652, 126, 984, 149, -780, -234, 335, -608, 836, 555, -362, 74, -778, -995, 563, 843, 
    -443, 422, 689, -364, 128, 61, -530, -1016, 330, -351, 484, -714, 334, -860, 91, 1007, 554, 1009, 978, 171, -26, -88, 900, -744, 446, 925, -143, 742, 245, 389, -253, -207, -982, -76, 238, 267, -242, -935, -441, -898, 923, -100, 612, 918, -922, 212, -504, 100, -219, 953, -289, 722, -795, 6, 430, -395, -483, 295, 818, 235, -96, 612, -776, 8, 
    874, -814, 915, 845, -227, -310, 94, -684, 200, -462, 570, 777, 99, 883, -409, -862, 823, -971, 320, 561, -388, 591, 1006, 616, 173, 141, 815, -714, 171, -149, 578, 447, -247, 596, -489, 505, -588, -481, 138, -324, -382, -133, -295, -885, -909, -985, -966, 773, -508, 412, 559, 110, -674, -112, 272, -555, -983, 522, 384, 377, -1007, -858, 749, -912};
    double Ztemp[in_rows][w_cols];  //single head output

    volatile uint64_t end1 = *time;
    printf("Init: %ld",(end1-start1));

    printf("Input: \n");
    for(int i = 0; i < in_rows; i++){
        for(int j = 0; j < in_cols; j++){
            printf("%lf, ",X[i][j]);
        }
        printf("\n");
    }
    printf("\n");

    volatile uint64_t start2 = *time;

    single_head(in_rows, in_cols, w_cols, X, WQ, WK, WV, Ztemp);    

    volatile uint64_t end2 = *time;
    printf("Comp: %ld",(end2-start2));

    printf("Output: \n");
    for(int i = 0; i < in_rows; i++){  
        for(int j = 0; j < w_cols; j++){
            printf("%lf, ",Ztemp[i][j]);
        }
        printf("\n");
    }
    printf("\n");

    return 0;                     

}        
    