//Usage
// gcc coder1.c -lm
// ./a.out > out1.txt

#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <math.h>

#define in_rows 4                  //Input rows
#define in_cols 64                 //Input columns
#define w_cols 16                 //Weights columns

void matmul(int inp_rows, int inp_cols, int wgt_cols, double inp[inp_rows][inp_cols], double  wgt[inp_cols][wgt_cols], double outp[inp_rows][wgt_cols]){
   int i, j, x;
   for (i = 0; i < inp_rows; i++) {
        for (j = 0; j < wgt_cols; j++) {
            outp[i][j] = 0;
            for (x = 0; x < inp_cols; x++) {
                *(*(outp + i) + j) += *(*(inp + i) + x)
                                     * *(*(wgt + x) + j);
            }
        }
    }
};

void transpose(int inp_rows, int inp_cols, double inp[inp_rows][inp_cols], double outp[inp_cols][inp_rows]){
    for(int i = 0; i < inp_rows; i++){
        for(int j = 0; j < inp_cols; j++){
            outp[j][i] = inp[i][j];
        }
    }

};

void softmax(int inp_rows, int inp_cols, double inp[inp_rows][inp_cols], double outp[inp_rows][inp_cols]){

    double m, sum, offset;

    for(int j = 0; j < inp_rows; j++){    

        m = -INFINITY;
        for (int i = 0; i < inp_cols; i++) {
            if (inp[j][i] > m) {
            m = inp[j][i];
            }
        }

        sum = 0.0;
        for (int i = 0; i < inp_cols; i++) {
            sum += exp(inp[j][i] - m);
        }

        offset = m + log(sum);

        for (int i = 0; i < inp_cols; i++) {
            outp[j][i] = exp(inp[j][i] - offset);
        }
    }
};

void single_head(int inp_rows, int inp_cols, int wt_cols, double X[inp_rows][inp_cols], double WQ[inp_cols][wt_cols], double WK[inp_cols][wt_cols],  double WV[inp_cols][wt_cols], double Z[inp_rows][wt_cols]){
    double norm = sqrt(wt_cols);
    double Q[inp_rows][wt_cols], K[inp_rows][wt_cols], V[inp_rows][wt_cols];

    matmul(inp_rows, inp_cols, wt_cols, X, WQ, Q);
    matmul(inp_rows, inp_cols, wt_cols, X, WK, K);
    matmul(inp_rows, inp_cols, wt_cols, X, WV, V);

    double KT[wt_cols][inp_rows];
    transpose(inp_rows, wt_cols, K, KT);

    double QKT[inp_rows][inp_rows];
    matmul(inp_rows, wt_cols, inp_rows, Q, KT, QKT);
    
    for(int i = 0; i < inp_rows; i++){
        for(int j = 0; j < inp_rows; j++){
            QKT[i][j] = QKT[i][j]/norm;
        }
    }  

    double softop[inp_rows][inp_rows];

    softmax(inp_rows, inp_rows, QKT, softop);

    matmul(inp_rows, inp_rows, wt_cols, softop, V, Z);
};


int main() {

    volatile uint64_t *time = 0xBFF8;   //Change the address here
    volatile uint64_t start1 = *time;

    //Input
    double X[in_rows][in_cols] = {511, -947, 191, -438, 254, 184, -626, -960, 833, -326, 457, 99, 960, -223, 1017, -969, -611, 63, 220, 765, -909, -882, -746, -728, 225, 606, -1014, -405, 511, 13, 442, -382, -328, 830, -845, -449, -628, -143, -652, -264, 450, -180, -561, 379, 89, 690, -983, 172, 685, 430, -595, -722, 710, -491, -811, -589, 180, 915, -965, 63, -44, -811, -686, 902, 
-553, -67, 203, 92, -99, 894, -232, -442, 294, 648, -215, -574, -57, -727, 419, 485, 586, 914, -751, -605, -203, 623, 993, 494, 1018, -429, -132, 746, -219, -995, -12, -315, -832, 162, 477, 791, -223, -559, 199, -917, -292, -935, -192, -433, -115, -601, -394, 445, -377, -17, 122, 722, -795, -661, -138, 924, 949, -81, -943, 450, -161, -228, 205, -473, 
794, 260, 698, 356, 651, 455, 380, 683, -442, -473, 1024, -21, 447, 805, -579, 37, 616, -102, 893, 229, 251, -418, -392, -716, 490, -308, -806, 663, 378, 937, -41, 59, -1022, -315, -514, 477, 662, 662, 8, -919, -567, -541, -925, -51, -183, -362, 292, -363, -533, 445, -397, -802, 818, -74, -225, 595, 218, 331, 107, -167, -337, -51, 1000, 404, 
-412, 813, 41, 559, -382, -53, -742, -402, -328, 554, 927, 809, 979, -40, -579, -524, -997, 415, 588, 859, -220, -41, 780, 829, -173, -181, -493, 99, -559, -178, -947, -388, 199, 198, 513, -285, 989, 212, -562, 969, -374, -214, -701, 841, 927, -528, -776, -538, -663, 51, 175, 916, -237, 750, -116, 20, 85, 376, -968, 299, 909, -593, 219, 144};
    //Weight matrices for every head
    double WQ[in_cols][w_cols] = {-442, 315, -239, 441, 432, 237, -44, -347, 513, 433, -959, -316, -866, -968, -90, 481, 225, 556, -870, -872, -465, -752, 576, -985, 631, -750, 277, -120, 783, -327, 803, -65, -510, -151, -311, -770, -436, -928, 418, 390, -366, 163, 925, 596, 719, 498, -892, -516, 695, 974, 53, 964, -359, 134, 214, -880, -187, -677, -212, 746, 35, 772, 385, 88, 
-80, -204, 876, 631, 294, -488, 818, 132, 41, 478, 164, 579, -209, 904, -892, 895, 378, 665, 297, 421, 309, 666, 457, -157, -565, -77, 182, -960, 993, -352, 369, -696, -598, 27, 493, 551, 189, -807, -805, 596, -801, 347, 950, 152, -459, -610, -817, 30, -470, -370, -850, -295, -137, 588, -253, 151, -269, 585, -942, 734, -857, 223, -337, -896, 
38, -991, 354, -3, -947, 803, 844, -182, 847, -907, -164, 284, -54, -138, -835, 657, -864, -539, -388, -23, -768, -160, 438, 848, 219, -636, 885, 710, 156, 231, -770, 417, 167, -843, 289, -442, -1013, 50, -748, 732, 133, 87, -31, 598, -105, -770, 170, 616, -115, 71, -754, 598, 324, -446, 908, -987, -615, -592, -92, -1011, 96, -869, -487, 220, 
-436, -27, -361, 764, 1024, 854, 557, 713, -521, -444, 883, -600, 423, 1009, -250, -974, -652, -710, -324, 278, -377, 978, -431, 826, 213, 989, -565, -148, -351, -190, -347, -158, -828, 572, -7, 862, 616, -743, 395, -720, 496, -652, 853, 951, -6, 320, 814, -497, -417, -358, 716, -790, -752, -45, -414, 874, 883, 969, -722, 703, 334, -334, -367, 70, 
-516, 817, 738, -395, 358, 1013, 502, -766, -943, -522, 572, -237, -934, 825, -156, 315, -767, 662, -1002, -346, -243, 343, 815, -314, 306, -712, 368, 865, -773, -294, -166, -102, -684, 400, -275, -285, -95, 479, 260, 1019, 603, 933, -726, -907, 684, 174, 189, 499, 282, 266, -784, -146, 500, -846, -743, -881, 274, 50, -214, 338, 565, 608, 368, 852, 
-851, 876, 372, -826, -631, -701, 918, -656, -641, 121, -224, -181, 390, -744, -201, 677, -69, -599, -119, 281, -791, 832, 431, 472, 1010, 491, 118, -553, -180, -461, -262, 721, -724, 720, 845, 1012, -860, -224, -134, 630, -900, 51, 155, -225, -831, -30, 575, -837, -326, 755, -473, -19, 613, 530, 742, -217, 840, 939, 422, 825, -692, -988, 918, 456, 
-505, -80, 725, -317, 256, 850, -450, -466, -531, -210, 884, -5, -754, 150, 523, 531, 436, 898, 634, 485, 473, -128, -896, 516, 833, -883, 879, -720, 510, -104, 760, -835, 104, -527, -144, -20, 277, 403, -339, 628, 774, -95, -585, 873, 402, 901, 414, 756, -132, -931, -965, 475, -437, -71, 347, 673, 695, -591, 992, -804, 47, 955, 113, 76, 
-377, -100, -727, -583, 611, 342, -145, 713, 289, 523, 186, 328, -381, 889, -269, 3, 442, -280, 162, 814, -700, -967, -746, -700, -459, 221, -787, -1004, -718, 223, -381, 518, -302, 961, 35, -437, -521, 99, -471, 631, -395, 391, -893, 94, 414, -399, -319, -780, -631, -146, 788, -722, 760, 109, 29, -999, 508, 206, 50, -621, -688, 629, -274, -378, 
-161, -37, 335, 91, -317, -146, -147, -147, -250, -1017, 125, -537, 160, -284, 85, 191, -901, 555, 912, 93, -501, -350, 539, 472, -179, 855, -254, -193, 970, 899, 873, -712, -806, 923, 9, -275, 598, 580, 164, -250, -771, -767, 267, -246, -629, -644, 322, 94, -346, 27, -9, 426, -132, 267, -393, 1001, -754, -265, -570, 413, -573, -582, 236, -461, 
-842, -996, 584, 637, 665, 218, 964, -1, 582, 881, -674, -220, -206, 455, -169, 150, 250, 228, -424, -102, 845, 824, 893, 388, 406, 969, -335, -43, 1003, 882, -107, 464, 227, -765, -478, -108, -876, 379, 875, -590, -49, -690, 212, -785, 611, 577, 327, 73, 226, -113, -283, -55, -914, -641, -515, 852, 278, -917, 363, -707, -760, -410, -988, 912, 
-661, -315, 391, 290, 388, 104, 13, -27, -939, -494, 909, -915, 47, -200, -552, -449, 575, -625, -72, -630, -425, -481, 1015, -971, -24, -623, 888, -815, 58, 308, 897, 786, 303, 106, 512, 568, -335, 926, 334, -870, -718, 869, 918, -681, -778, 742, -929, 131, 491, 425, -997, 396, -370, 92, 450, 487, 833, -694, -649, 81, 232, -134, 510, 643, 
-736, -181, 886, 208, 758, 519, 853, 587, -153, 827, -181, -207, 393, 322, 713, -924, 37, -469, -302, -330, -298, -908, 938, -488, -816, -774, -892, -100, -634, 953, 561, 232, -193, -840, -144, -449, 762, -996, -576, -305, -583, 958, -30, -667, -519, -468, -538, -408, 503, -84, 520, 323, -420, 306, 411, 595, -987, -522, -916, 201, 393, 769, -216, -750, 
469, -187, -185, -1019, -809, 34, -230, -863, -65, -128, -756, -6, -212, 219, -912, -704, 418, -691, -488, -251, 732, -204, 66, 171, 245, 343, 359, -559, -174, 53, 729, 347, 665, -301, -317, -215, -443, -411, -958, 37, -555, -57, -938, -280, -392, -7, -375, 586, 68, -283, 369, 918, -684, 390, 508, -851, -332, 15, 572, -911, 910, 575, -808, -480, 
15, 1002, -240, 839, 240, 994, -799, 222, 206, -340, 752, 1024, 758, 761, 180, 18, -755, -1005, -666, -199, -451, 291, -560, -880, 260, -262, -16, -484, 182, -855, -824, 351, -302, 388, -552, -193, 897, 298, 506, -361, -849, -81, -16, -513, 914, 711, 274, 220, 368, 989, -570, -239, 997, -621, 88, 219, 652, 870, 211, 533, 458, 208, -646, -10, 
417, -52, -812, -220, -821, -22, 673, -685, -212, -669, 81, 445, 289, -779, 568, 46, 380, -629, -265, -278, 823, -756, 905, 39, -712, 832, -779, 494, 156, -808, -563, 208, 796, -376, -395, -71, -1, 390, 283, 806, -59, -10, -226, 993, 905, -741, 1010, 446, 901, 495, -128, 1016, 604, -968, -755, 692, -727, 360, 402, 566, 523, -42, 651, 966, 
56, 343, 556, -83, -835, 992, -184, -231, -374, -625, 1017, -300, 948, -853, -602, 850, 677, 463, -509, 982, 915, -318, -77, 228, -908, 922, -234, -761, 590, -649, -42, -793, 371, 752, 239, 287, 869, -810, 181, -338, -753, -114, -414, -611, 510, 795, 871, -589, -188, -194, 57, -296, 967, 332, 339, -517, -610, 763, 311, 268, -210, -802, 729, -502};
    double WK[in_cols][w_cols] = {378, 91, 868, 805, 982, 223, 461, -74, -759, 895, -145, 614, 1012, 738, -432, -979, 570, 319, -25, -241, 717, -863, 24, -1008, -413, -987, -1020, -392, -191, 894, -347, -452, -503, -432, 5, -783, 932, 287, 116, -759, -829, 905, 922, -690, 975, 587, 677, -898, 960, -620, 798, 755, -290, 526, -337, -292, 452, 584, 719, -968, 224, 427, 495, 450, 
530, -149, -362, -773, 615, 409, -349, 596, -763, -462, 959, -587, -695, 275, 753, 902, -841, -457, 325, -744, 7, 493, 188, -488, 577, 473, -979, -829, -182, 314, 791, -310, 833, 555, 887, 941, -612, 267, 1013, 847, -77, 947, -316, 95, -521, -467, 249, 322, -288, 411, 333, 973, -1002, -729, -390, 969, 516, 530, 646, -631, 644, 599, 370, -945, 
-415, -163, -781, 300, -499, 434, -776, 1023, 658, 208, 9, 146, 498, 778, 369, 442, -251, -739, 389, -699, 166, 199, -132, 419, 413, -928, -421, 612, 11, 932, -817, 874, -254, -481, -906, -119, 333, -706, -862, 221, 435, 215, 792, 780, 999, 439, -721, -1005, -818, -885, -580, 288, 1021, -296, 950, 319, -961, 716, -403, -434, -166, 373, -647, -217, 
341, 934, 1019, -554, -631, 626, 790, -30, 3, 338, 161, 935, 159, 10, 746, -310, -910, 562, 74, -824, 322, -15, 993, 446, 341, 405, 235, 267, -827, 172, 438, 2, 755, 813, -496, -961, -483, -568, -218, -744, -352, 70, -925, 914, 949, 926, -371, -425, -679, -392, 912, 366, 919, -6, -455, -401, 408, -589, 754, 458, 851, 405, 362, 441, 
-591, -724, -158, -216, -336, 740, 180, 671, -77, 41, 225, 100, -871, -65, 679, -980, 765, 267, -956, 67, 919, -512, -61, 881, 692, 206, -102, -833, -392, -441, 428, 840, 158, 798, -998, 767, 222, 854, 414, 724, -607, 742, 1003, -564, 977, -349, -332, -308, -673, -994, -436, -975, -318, -652, 649, -359, 543, 919, -977, 38, -523, 175, -307, -280, 
966, 140, 361, 608, -444, 745, 64, -363, 389, 94, 748, -812, -253, -230, 696, 499, 882, -597, 705, -731, 870, 210, -235, 407, 443, 391, -717, -412, -396, -314, -716, 722, -565, -585, -50, 674, -151, -145, -886, -405, -442, 373, -128, 890, 171, 456, -75, -1018, 268, 780, 457, -434, 815, 246, -578, 461, 267, 617, -755, 212, -22, -113, 191, 890, 
-584, -465, -94, 33, -494, 716, -327, 188, -292, 584, 145, 767, -274, -656, -619, 239, 746, -870, 577, -913, 10, -739, 151, -674, -85, -794, -464, -526, 760, 29, 453, -75, -829, 317, -814, 873, 142, -804, -451, -816, -160, 195, 368, -808, -519, -182, 823, 547, 587, 335, 660, -621, -408, 155, -431, 735, -544, 490, -902, 299, 323, -283, -959, -990, 
990, 484, 783, 627, 392, -537, -884, 558, 686, 437, -737, 1011, 184, -246, 585, -70, 224, 135, 770, 912, 305, -750, 807, -809, 59, 175, 460, 39, 140, 687, -205, 569, -140, -992, -512, 351, -664, -977, -554, -850, -322, 704, -616, 288, -512, 664, -792, -855, 964, 597, -374, -666, -474, -843, -441, 415, 947, 49, -137, -622, -397, 307, -968, -1008, 
696, -531, -322, 228, -815, -936, -924, -394, -272, -510, -77, 576, -252, -912, 104, -496, -592, 534, -525, 728, 456, 549, -166, 37, 785, 263, 282, 918, -120, 745, 202, -881, 26, -1001, 704, 532, -470, 780, -790, 291, 681, -828, 933, -976, 483, 1017, -512, 302, -373, -294, -393, -208, -773, 472, -531, 891, -628, -991, -435, -397, 701, 585, -257, -643, 
197, -51, -422, -643, -481, -103, -450, 301, -41, 208, -871, 743, -200, 871, 131, 997, 1004, 516, 216, -887, 78, -888, 589, 314, 432, 499, 118, -677, 238, -168, 160, -703, -499, 858, -156, 341, -893, -36, 350, -188, 754, 446, 772, 445, 203, -776, 901, -463, 349, -619, -672, 1005, -634, 451, 444, -135, 528, -297, 736, -926, -205, 822, 725, -516, 
261, -217, -972, 624, -742, 850, -680, -306, 122, -207, 77, 990, 672, 69, -248, -467, 373, -344, -678, -990, -569, 415, 351, 762, -35, -751, -296, 439, 135, 334, -380, 736, 308, -596, -301, 154, -393, 862, -590, 316, 126, -492, -83, -172, 448, -850, -246, 664, -274, -370, -592, -118, -894, -514, 947, -108, -1005, -234, -26, -76, -573, -853, -475, -547, 
-643, -884, -503, -217, 303, 422, 842, -480, 717, 248, 495, 995, -802, 553, -727, -632, 197, 510, 938, 551, 103, -682, 200, 546, 1010, -451, 497, 249, -348, 177, -124, 127, 447, -12, 891, 510, -392, 778, 452, -311, 114, 679, -423, 539, -630, -21, 774, -727, -599, -110, -243, -429, 15, 691, -987, 807, -641, 564, -854, 373, 314, -356, -162, 525, 
-888, 869, -638, 831, 372, 720, 961, -722, -204, -789, 861, -986, -174, -8, -343, 541, 367, -513, -131, 776, -549, -63, 96, 30, 821, -434, 389, 984, -607, -115, -566, -640, -796, 190, 485, -617, -649, 939, 872, 320, 133, -1020, -368, 408, -868, 911, 746, -565, -326, -911, -743, -505, -976, 241, 494, 349, 832, -888, -467, 1020, 400, 655, -363, -882, 
115, 146, -755, 621, -680, 223, -740, 491, -174, -69, -517, -788, 814, -339, 645, 384, 685, 600, 203, -243, -913, 510, 229, 465, -783, -588, -206, -797, -809, 556, -499, -372, 682, 901, 467, 352, 120, -697, 658, -375, 655, 96, -668, 909, -7, 759, -840, 686, -87, -308, -428, -305, 385, 591, 495, 374, 631, 715, 94, 249, -303, 765, -1004, 844, 
323, 864, 533, 771, -986, -806, -514, 242, -309, 265, -644, -794, 923, 240, -639, 288, 923, -752, -526, -378, 262, 413, -510, 706, 362, 873, 25, 663, -496, 458, -325, -897, -537, -751, -721, -667, 105, -618, 5, -163, 409, 867, 18, 200, 584, 551, 558, 42, 787, 1003, 214, 193, 697, -728, 149, -166, 462, -605, 919, -429, -149, -464, 1010, 97, 
-424, 641, -493, 384, 831, -36, 635, 1009, 350, 517, 479, -657, -829, -329, 927, -883, -752, -964, 643, -855, 110, -396, -348, 93, 305, -329, 234, -612, 922, 975, -507, 1020, 458, 625, -572, 68, -66, 645, -13, 799, -281, -657, 473, 832, 320, 793, -341, 95, 966, 606, -800, 156, -182, 937, 607, 711, -509, -701, -634, -495, -337, -324, 986, 260};
    double WV[in_cols][w_cols] = {678, -44, 341, 214, 922, -330, -356, 40, 162, -868, 843, 815, 310, 110, -366, -467, -77, -655, -696, 796, 106, -864, -59, -98, -701, -111, -898, 390, 167, 796, -536, 489, 124, -531, 206, -274, 1024, -276, -338, -49, -647, 552, 292, -247, -115, 641, 24, -88, 876, 834, 568, -378, -628, -1007, 260, -879, 670, 810, 414, -853, 930, 121, -652, -114,
869, 606, -996, -525, -709, 388, -532, 955, 506, -363, 875, 829, -895, 563, 235, -914, -652, -6, -285, 135, -839, -95, -454, 144, -861, 373, -368, -680, 595, -299, -789, -678, 448, 461, 220, 396, 81, 415, 343, -475, -317, -419, 327, 498, -95, 234, -253, -883, 29, -268, 365, 799, -76, -227, 845, -155, -965, -262, 965, -245, -761, 625, 385, 253,
-628, -907, -839, -13, -222, -681, 252, -523, -183, -9, 719, -781, -965, -551, 857, -918, 893, 328, -547, 895, 250, -170, 252, 267, 549, -69, 954, 590, -143, -446, 891, 983, 855, 160, 302, -66, 691, -377, -68, 615, 133, -457, -521, -165, -845, -991, -925, -872, 116, -700, -686, -263, 952, 618, -428, 162, -448, -670, -898, 161, 927, 285, 24, 797,
730, 830, -21, -517, -640, 27, -841, -282, 371, 377, -840, 115, 961, -151, -346, 379, 746, 89, 432, 622, -59, -375, 885, -369, 194, -574, -158, -302, -89, -560, -471, 186, -332, 59, -979, -625, 749, 67, -960, 548, 457, -32, -425, -638, 789, -721, -945, -787, 274, -126, 1006, 931, 498, 868, -605, -406, -733, 442, -283, 521, 489, 723, -171, 745,
565, 362, 602, 622, 34, 489, -425, 478, -528, -469, -27, -149, 779, 285, 229, 749, 149, 477, 410, -837, -506, 212, -630, 299, 175, 532, -242, 370, 617, 614, -253, -977, 223, -102, -431, 257, -780, -851, -650, -27, 884, 42, -960, -873, 753, 1001, -894, -322, -84, 806, 233, 868, -912, 505, 374, 717, 811, 114, 569, 652, 844, 470, 489, 85,
-554, -970, -242, -822, 645, -844, -930, 113, 782, -696, -65, 97, 924, -224, 675, -580, 38, 872, 628, 195, -691, 417, 288, -952, 758, -337, 796, 531, 350, 642, -575, -930, -781, 726, -826, -481, 359, 704, 733, -644, -972, -2, 580, -298, -625, -92, -952, -890, 478, 226, 418, -681, -378, 772, -239, -531, -84, -431, -885, 92, 907, 571, -413, 245,
-574, -564, 323, 497, -36, -534, 630, -788, -724, 877, -34, 16, -314, -918, -702, -383, -942, 207, -285, -51, -51, -866, 205, 880, -295, -989, 56, 643, -830, 518, -577, 6, -749, 870, 366, 57, 302, 658, 230, -896, -618, -680, -527, 254, 525, -957, -65, -980, 832, 561, -295, -42, 304, -381, 619, 904, 834, -934, -221, 125, -388, 933, 1021, 632,
664, -458, -714, 213, -258, 551, -145, -519, 789, -826, 17, 305, 873, 570, -263, 526, -210, -612, 222, 323, -278, -326, 240, 802, -118, 1010, 459, -85, -481, -179, -824, 742, 429, -255, -895, 254, -766, 591, 563, -15, -191, -723, -266, -87, -486, 927, -10, -174, 877, -150, -427, -53, -842, -958, 491, 415, 860, 163, 910, 101, -859, 875, 592, -818,
841, 397, 962, 11, 244, 743, -8, -128, 726, 327, 475, -136, 934, 1024, 943, -431, -78, 932, -54, -516, 902, 66, -77, -826, 422, -35, -521, -233, -737, -477, -288, -846, -215, 597, -356, -674, 213, 379, 463, 916, 804, 57, -165, -12, 534, -937, -657, 836, -638, 997, 971, 587, 213, -232, 162, -881, 594, 369, 254, 88, -947, 734, -48, 63,
-469, 527, 447, 67, -172, 145, 1, -1016, 744, 468, 903, 444, 768, -774, 559, 394, -574, 652, -182, 754, 767, 1018, -817, 803, -832, 164, 586, 104, -102, 677, -219, -561, 1013, -171, -5, -259, 354, 370, 855, -941, -45, 988, -940, -925, -11, -926, 636, 928, -1015, -543, 178, 715, 871, -13, 224, -288, 87, -18, 849, 520, 820, -278, -920, 512,
480, 646, 50, -1018, -919, 475, 784, -872, 245, -481, -451, -3, -497, 1021, -276, -448, 594, 356, -623, 13, 625, 648, 200, 534, -684, -597, -62, 931, 831, 842, -141, 15, 562, -647, 828, -493, 296, -750, 472, 527, 449, -291, -324, 770, 503, 427, 857, -418, -821, 361, -479, -7, -537, -976, -483, 25, -708, -706, -838, -194, -735, 630, -160, -848,
622, 445, 181, 802, -285, 915, -496, -839, -679, 1010, 53, -26, 670, 34, -497, -460, -964, 643, 535, 110, 368, -1007, 685, -190, 102, 907, -858, -1, -397, -277, -771, 892, 425, 232, -773, -552, 445, 284, 518, -448, 228, 135, 531, 743, -464, 503, -705, -908, -129, -139, -890, 774, -107, -472, -140, 312, -566, -384, 309, -733, -2, -760, 648, 125,
-3, -232, -563, -648, 1021, -404, -223, -265, -240, -780, 288, 955, -685, -302, -72, 652, 711, -622, 833, -927, 26, -40, 716, 190, 167, 630, 479, -68, 539, 619, 708, -39, -532, 557, 566, 592, 453, -881, -694, 190, 756, 974, -392, -447, 825, 152, 746, -667, 739, 824, -637, -274, -437, 663, -332, -396, 716, 893, 16, 379, 346, -829, 482, -341,
457, -130, -58, 830, 265, 194, -123, -136, -660, -996, 16, -924, -401, -418, 17, -137, -571, -432, 955, -931, 844, 987, 985, -664, -953, 704, 37, 738, -643, -607, -107, -135, 992, 174, 570, 115, 199, 851, -566, 657, -57, 676, -53, -222, -606, 477, 956, -152, -135, 908, -653, 460, -312, 222, 500, 327, 689, -929, -833, -999, -49, 144, 633, 388,
673, -385, 326, 423, -711, -134, 714, -194, -24, -969, 41, -904, 637, 440, -934, 550, -546, -390, -654, 528, -370, -246, -729, -643, -913, 493, 946, -651, 89, 534, -913, -483, 287, -205, 560, 732, 470, -480, 542, 724, 854, -494, 351, 322, -865, -992, -237, -193, 722, -521, 289, 939, -589, -724, 521, -888, 534, 32, -331, 901, -947, 924, -876, 527,
-336, -514, -453, -190, 272, -612, 619, 598, 731, -1000, -180, -426, -462, 801, -342, -142, 179, -61, 686, -606, -913, 559, 372, -946, 528, -990, -493, 473, -447, -161, 357, -393, 168, -282, 574, 669, 344, -651, -959, -528, 961, -494, -440, 34, 429, 207, -847, -630, -455, 1016, -489, 923, 644, -920, -236, 36, -492, -948, -107, 536, 96, -636, 435, 534};
    double Ztemp[in_rows][w_cols];  //single head output

    volatile uint64_t end1 = *time;
    printf("Init: %ld",(end1-start1));

    printf("Input: \n");
    for(int i = 0; i < in_rows; i++){
        for(int j = 0; j < in_cols; j++){
            printf("%lf, ",X[i][j]);
        }
        printf("\n");
    }
    printf("\n");

    volatile uint64_t start2 = *time;

    single_head(in_rows, in_cols, w_cols, X, WQ, WK, WV, Ztemp);    

    volatile uint64_t end2 = *time;
    printf("Comp: %ld",(end2-start2));

    printf("Output: \n");
    for(int i = 0; i < in_rows; i++){  
        for(int j = 0; j < w_cols; j++){
            printf("%lf, ",Ztemp[i][j]);
        }
        printf("\n");
    }
    printf("\n");

    return 0;                     

}        
    